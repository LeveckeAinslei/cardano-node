<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{-
Module      : Cardano.TxGenerator.Utils
Description : Utility functions used across the transaction generator.
-}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span>  </span><span class="hs-identifier">Cardano.TxGenerator.Utils</span><span>
</span><span id="line-11"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Cardano.TxGenerator.Utils.html"><span class="hs-identifier">Cardano.TxGenerator.Utils</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier">fromJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/a252mxmjl9dr6r0lfdazazn9ind0l01w-cardano-api-lib-cardano-api-8.29.0.0-haddock-doc/share/doc/cardano-api/html/src/Cardano.Api.html"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.TxGenerator.Types.html"><span class="hs-identifier">Cardano.TxGenerator.Types</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- | `liftAnyEra` applies a function to the value in `InAnyCardanoEra`</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- regardless of which particular era.</span><span>
</span><span id="line-23"></span><span id="local-6989586621679811298"><span id="local-6989586621679811299"><span class="annot"><a href="Cardano.TxGenerator.Utils.html#liftAnyEra"><span class="hs-identifier hs-type">liftAnyEra</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679811296"><span class="annot"><a href="#local-6989586621679811296"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsCardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811296"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811298"><span class="hs-identifier hs-type">f1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811296"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811299"><span class="hs-identifier hs-type">f2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811296"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811298"><span class="hs-identifier hs-type">f1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811299"><span class="hs-identifier hs-type">f2</span></a></span></span></span><span>
</span><span id="line-24"></span><span id="liftAnyEra"><span class="annot"><span class="annottext">liftAnyEra :: forall (f1 :: * -&gt; *) (f2 :: * -&gt; *).
(forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era)
-&gt; InAnyCardanoEra f1 -&gt; InAnyCardanoEra f2
</span><a href="Cardano.TxGenerator.Utils.html#liftAnyEra"><span class="hs-identifier hs-var hs-var">liftAnyEra</span></a></span></span><span> </span><span id="local-6989586621679811440"><span class="annot"><span class="annottext">forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679811441"><span class="annot"><span class="annottext">InAnyCardanoEra f1
</span><a href="#local-6989586621679811441"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InAnyCardanoEra f1
</span><a href="#local-6989586621679811441"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">ByronEra</span></span><span> </span><span id="local-6989586621679811448"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811448"><span class="hs-identifier hs-var">a</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra ByronEra -&gt; f2 ByronEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra ByronEra
</span><span class="hs-identifier hs-var">ByronEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 ByronEra -&gt; InAnyCardanoEra f2)
-&gt; f2 ByronEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 ByronEra -&gt; f2 ByronEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 ByronEra
</span><a href="#local-6989586621679811448"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">ShelleyEra</span></span><span> </span><span id="local-6989586621679811455"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811455"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra ShelleyEra -&gt; f2 ShelleyEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra ShelleyEra
</span><span class="hs-identifier hs-var">ShelleyEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 ShelleyEra -&gt; InAnyCardanoEra f2)
-&gt; f2 ShelleyEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 ShelleyEra -&gt; f2 ShelleyEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 ShelleyEra
</span><a href="#local-6989586621679811455"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">AllegraEra</span></span><span> </span><span id="local-6989586621679811462"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811462"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra AllegraEra -&gt; f2 AllegraEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra AllegraEra
</span><span class="hs-identifier hs-var">AllegraEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 AllegraEra -&gt; InAnyCardanoEra f2)
-&gt; f2 AllegraEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 AllegraEra -&gt; f2 AllegraEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 AllegraEra
</span><a href="#local-6989586621679811462"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">MaryEra</span></span><span> </span><span id="local-6989586621679811469"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811469"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra MaryEra -&gt; f2 MaryEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra MaryEra
</span><span class="hs-identifier hs-var">MaryEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 MaryEra -&gt; InAnyCardanoEra f2)
-&gt; f2 MaryEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 MaryEra -&gt; f2 MaryEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 MaryEra
</span><a href="#local-6989586621679811469"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">AlonzoEra</span></span><span> </span><span id="local-6989586621679811476"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811476"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra AlonzoEra -&gt; f2 AlonzoEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra AlonzoEra
</span><span class="hs-identifier hs-var">AlonzoEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 AlonzoEra -&gt; InAnyCardanoEra f2)
-&gt; f2 AlonzoEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 AlonzoEra -&gt; f2 AlonzoEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 AlonzoEra
</span><a href="#local-6989586621679811476"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">BabbageEra</span></span><span> </span><span id="local-6989586621679811483"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811483"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra BabbageEra -&gt; f2 BabbageEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra BabbageEra
</span><span class="hs-identifier hs-var">BabbageEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 BabbageEra -&gt; InAnyCardanoEra f2)
-&gt; f2 BabbageEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 BabbageEra -&gt; f2 BabbageEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 BabbageEra
</span><a href="#local-6989586621679811483"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
</span><span class="hs-identifier hs-var">ConwayEra</span></span><span> </span><span id="local-6989586621679811490"><span class="annot"><span class="annottext">f1 era
</span><a href="#local-6989586621679811490"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><span class="annottext">CardanoEra ConwayEra -&gt; f2 ConwayEra -&gt; InAnyCardanoEra f2
forall era (thing :: * -&gt; *).
IsCardanoEra era =&gt;
CardanoEra era -&gt; thing era -&gt; InAnyCardanoEra thing
</span><span class="hs-identifier hs-var">InAnyCardanoEra</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra ConwayEra
</span><span class="hs-identifier hs-var">ConwayEra</span></span><span> </span><span class="annot"><span class="annottext">(f2 ConwayEra -&gt; InAnyCardanoEra f2)
-&gt; f2 ConwayEra -&gt; InAnyCardanoEra f2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f1 ConwayEra -&gt; f2 ConwayEra
forall era. IsCardanoEra era =&gt; f1 era -&gt; f2 era
</span><a href="#local-6989586621679811440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f1 era
f1 ConwayEra
</span><a href="#local-6989586621679811490"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">-- | `keyAddress` determines an address for the relevant era.</span></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#keyAddress"><span class="hs-identifier hs-type">keyAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679811323"><span class="annot"><a href="#local-6989586621679811323"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811323"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SigningKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressInEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811323"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-35"></span><span id="keyAddress"><span class="annot"><span class="annottext">keyAddress :: forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; SigningKey PaymentKey -&gt; AddressInEra era
</span><a href="Cardano.TxGenerator.Utils.html#keyAddress"><span class="hs-identifier hs-var hs-var">keyAddress</span></a></span></span><span> </span><span id="local-6989586621679811499"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679811499"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679811500"><span class="annot"><span class="annottext">SigningKey PaymentKey
</span><a href="#local-6989586621679811500"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; NetworkId
-&gt; PaymentCredential
-&gt; StakeAddressReference
-&gt; AddressInEra era
forall era.
ShelleyBasedEra era
-&gt; NetworkId
-&gt; PaymentCredential
-&gt; StakeAddressReference
-&gt; AddressInEra era
</span><span class="hs-identifier hs-var">makeShelleyAddressInEra</span></span><span>
</span><span id="line-37"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. IsShelleyBasedEra era =&gt; ShelleyBasedEra era
</span><span class="hs-identifier hs-var">shelleyBasedEra</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811323"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>      </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679811499"><span class="hs-identifier hs-var">networkId</span></a></span><span>
</span><span id="line-39"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash PaymentKey -&gt; PaymentCredential
</span><span class="hs-identifier hs-var">PaymentCredentialByKey</span></span><span> </span><span class="annot"><span class="annottext">(Hash PaymentKey -&gt; PaymentCredential)
-&gt; Hash PaymentKey -&gt; PaymentCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey -&gt; Hash PaymentKey
forall keyrole.
Key keyrole =&gt;
VerificationKey keyrole -&gt; Hash keyrole
</span><span class="hs-identifier hs-var">verificationKeyHash</span></span><span> </span><span class="annot"><span class="annottext">(VerificationKey PaymentKey -&gt; Hash PaymentKey)
-&gt; VerificationKey PaymentKey -&gt; Hash PaymentKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
(Key keyrole, HasTypeProxy keyrole) =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">SigningKey PaymentKey
</span><a href="#local-6989586621679811500"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><span class="annottext">StakeAddressReference
</span><span class="hs-identifier hs-var">NoStakeAddress</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- TODO: check sufficient funds and minimumValuePerUtxo</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#inputsToOutputsWithFee"><span class="hs-identifier hs-type">inputsToOutputsWithFee</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span id="inputsToOutputsWithFee"><span class="annot"><span class="annottext">inputsToOutputsWithFee :: Lovelace -&gt; Int -&gt; [Lovelace] -&gt; [Lovelace]
</span><a href="Cardano.TxGenerator.Utils.html#inputsToOutputsWithFee"><span class="hs-identifier hs-var hs-var">inputsToOutputsWithFee</span></a></span></span><span> </span><span id="local-6989586621679811508"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811508"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span id="local-6989586621679811509"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679811509"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679811510"><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811510"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace) -&gt; [Integer] -&gt; [Lovelace]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity -&gt; Lovelace
</span><span class="hs-identifier hs-var">quantityToLovelace</span></span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Lovelace)
-&gt; (Integer -&gt; Quantity) -&gt; Integer -&gt; Lovelace
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
</span><span class="hs-identifier hs-var">Quantity</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679811514"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Quantity</span></span><span> </span><span id="local-6989586621679811515"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811515"><span class="hs-identifier hs-var">totalAvailable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Quantity
</span><span class="hs-identifier hs-var">lovelaceToQuantity</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Quantity) -&gt; Lovelace -&gt; Quantity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; Lovelace
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811510"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811508"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679811518"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811518"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679811519"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811519"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#divMod"><span class="hs-identifier hs-var">divMod</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811515"><span class="hs-identifier hs-var">totalAvailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679811509"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679811514"><span class="annot"><span class="annottext">outputs :: [Integer]
</span><a href="#local-6989586621679811514"><span class="hs-identifier hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811518"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811519"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer] -&gt; [Integer]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; [Integer]
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679811509"><span class="hs-identifier hs-var">count</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679811518"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | 'includeChange' gets use made of it as a value splitter in</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- 'Cardano.TxGenerator.Tx.sourceToStoreTransactionNew' by</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- 'Cardano.Benchmarking.Script.Core.evalGenerator'.</span><span>
</span><span id="line-53"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#includeChange"><span class="hs-identifier hs-type">includeChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.TxGenerator.Types.html#PayWithChange"><span class="hs-identifier hs-type">PayWithChange</span></a></span><span>
</span><span id="line-54"></span><span id="includeChange"><span class="annot"><span class="annottext">includeChange :: Lovelace -&gt; [Lovelace] -&gt; [Lovelace] -&gt; PayWithChange
</span><a href="Cardano.TxGenerator.Utils.html#includeChange"><span class="hs-identifier hs-var hs-var">includeChange</span></a></span></span><span> </span><span id="local-6989586621679811524"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811524"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span id="local-6989586621679811525"><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811525"><span class="hs-identifier hs-var">spend</span></a></span></span><span> </span><span id="local-6989586621679811526"><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811526"><span class="hs-identifier hs-var">have</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811528"><span class="hs-identifier hs-var">changeValue</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; [Lovelace] -&gt; PayWithChange
</span><a href="Cardano.TxGenerator.Types.html#PayWithChange"><span class="hs-identifier hs-var">PayWithChange</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811528"><span class="hs-identifier hs-var">changeValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811525"><span class="hs-identifier hs-var">spend</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; PayWithChange
</span><a href="Cardano.TxGenerator.Types.html#PayExact"><span class="hs-identifier hs-var">PayExact</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811525"><span class="hs-identifier hs-var">spend</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PayWithChange
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PayWithChange) -&gt; [Char] -&gt; PayWithChange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;includeChange: Bad transaction: insufficient funds&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-58"></span><span>                </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n   have: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811526"><span class="hs-identifier hs-var">have</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-59"></span><span>                </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n  spend: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811525"><span class="hs-identifier hs-var">spend</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-60"></span><span>                </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n    fee: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811524"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679811528"><span class="annot"><span class="annottext">changeValue :: Lovelace
</span><a href="#local-6989586621679811528"><span class="hs-identifier hs-var hs-var">changeValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; Lovelace
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811526"><span class="hs-identifier hs-var">have</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; Lovelace
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679811525"><span class="hs-identifier hs-var">spend</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811524"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- some convenience constructors</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | `mkTxFee` reinterprets the `Either` returned by</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- `txFeesExplicitInEra` with `TxFee` constructors.</span><span>
</span><span id="line-68"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#mkTxFee"><span class="hs-identifier hs-type">mkTxFee</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679811359"><span class="annot"><a href="#local-6989586621679811359"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsCardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811359"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxFee</span></span><span> </span><span class="annot"><a href="#local-6989586621679811359"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-69"></span><span id="mkTxFee"><span class="annot"><span class="annottext">mkTxFee :: forall era. IsCardanoEra era =&gt; Lovelace -&gt; TxFee era
</span><a href="Cardano.TxGenerator.Utils.html#mkTxFee"><span class="hs-identifier hs-var hs-var">mkTxFee</span></a></span></span><span> </span><span id="local-6989586621679811536"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811536"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByronEraOnly era -&gt; TxFee era)
-&gt; (ShelleyBasedEraConstraints era =&gt;
    ShelleyBasedEra era -&gt; TxFee era)
-&gt; CardanoEra era
-&gt; TxFee era
forall era a.
(ByronEraOnly era -&gt; a)
-&gt; (ShelleyBasedEraConstraints era =&gt; ShelleyBasedEra era -&gt; a)
-&gt; CardanoEra era
-&gt; a
</span><span class="hs-identifier hs-var">caseByronOrShelleyBasedEra</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">ByronEraOnly era -&gt; TxFee era
forall era. ByronEraOnly era -&gt; TxFee era
</span><span class="hs-identifier hs-var">TxFeeImplicit</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; Lovelace -&gt; TxFee era
forall era. ShelleyBasedEra era -&gt; Lovelace -&gt; TxFee era
</span><span class="hs-operator hs-var">`TxFeeExplicit`</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811536"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. IsCardanoEra era =&gt; CardanoEra era
</span><span class="hs-identifier hs-var">cardanoEra</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811359"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | `mkTxValidityUpperBound` rules out needing the</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- `TxValidityNoUpperBound` with the constraint of `IsShelleyBasedEra`.</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#mkTxValidityUpperBound"><span class="hs-identifier hs-type">mkTxValidityUpperBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679811368"><span class="annot"><a href="#local-6989586621679811368"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811368"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/4ncj8wcy9dndb2p43jy3z82fd3npmv5i-cardano-slotting-lib-cardano-slotting-0.1.1.1-haddock-doc/share/doc/cardano-slotting/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxValidityUpperBound</span></span><span> </span><span class="annot"><a href="#local-6989586621679811368"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-77"></span><span id="mkTxValidityUpperBound"><span class="annot"><span class="annottext">mkTxValidityUpperBound :: forall era.
IsShelleyBasedEra era =&gt;
SlotNo -&gt; TxValidityUpperBound era
</span><a href="Cardano.TxGenerator.Utils.html#mkTxValidityUpperBound"><span class="hs-identifier hs-var hs-var">mkTxValidityUpperBound</span></a></span></span><span> </span><span id="local-6989586621679811552"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679811552"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; Maybe SlotNo -&gt; TxValidityUpperBound era
forall era.
ShelleyBasedEra era -&gt; Maybe SlotNo -&gt; TxValidityUpperBound era
</span><span class="hs-identifier hs-var">TxValidityUpperBound</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (ShelleyBasedEra era) -&gt; ShelleyBasedEra era
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (ShelleyBasedEra era) -&gt; ShelleyBasedEra era)
-&gt; Maybe (ShelleyBasedEra era) -&gt; ShelleyBasedEra era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era -&gt; Maybe (ShelleyBasedEra era)
forall (eon :: * -&gt; *) era.
Eon eon =&gt;
CardanoEra era -&gt; Maybe (eon era)
</span><span class="hs-identifier hs-var">forEraMaybeEon</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. IsCardanoEra era =&gt; CardanoEra era
</span><span class="hs-identifier hs-var">cardanoEra</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811368"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; Maybe SlotNo
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679811552"><span class="hs-identifier hs-var">slotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | `mkTxOutValueAdaOnly` reinterprets the `Either` returned by</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- `multiAssetSupportedInEra` with `TxOutValue` constructors.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#mkTxOutValueAdaOnly"><span class="hs-identifier hs-type">mkTxOutValueAdaOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679811377"><span class="annot"><a href="#local-6989586621679811377"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811377"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lovelace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679811377"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-83"></span><span id="mkTxOutValueAdaOnly"><span class="annot"><span class="annottext">mkTxOutValueAdaOnly :: forall era. IsShelleyBasedEra era =&gt; Lovelace -&gt; TxOutValue era
</span><a href="Cardano.TxGenerator.Utils.html#mkTxOutValueAdaOnly"><span class="hs-identifier hs-var hs-var">mkTxOutValueAdaOnly</span></a></span></span><span> </span><span id="local-6989586621679811560"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811560"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByronToAllegraEraConstraints era =&gt;
 ByronToAllegraEra era -&gt; TxOutValue era)
-&gt; (MaryEraOnwardsConstraints era =&gt;
    MaryEraOnwards era -&gt; TxOutValue era)
-&gt; CardanoEra era
-&gt; TxOutValue era
forall era a.
(ByronToAllegraEraConstraints era =&gt; ByronToAllegraEra era -&gt; a)
-&gt; (MaryEraOnwardsConstraints era =&gt; MaryEraOnwards era -&gt; a)
-&gt; CardanoEra era
-&gt; a
</span><span class="hs-identifier hs-var">caseByronToAllegraOrMaryEraOnwards</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByronToAllegraEra era -&gt; Lovelace -&gt; TxOutValue era
forall era. ByronToAllegraEra era -&gt; Lovelace -&gt; TxOutValue era
</span><span class="hs-operator hs-var">`TxOutAdaOnly`</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811560"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679811565"><span class="annot"><span class="annottext">MaryEraOnwards era
</span><a href="#local-6989586621679811565"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MaryEraOnwards era -&gt; Value -&gt; TxOutValue era
forall era. MaryEraOnwards era -&gt; Value -&gt; TxOutValue era
</span><span class="hs-identifier hs-var">TxOutValue</span></span><span> </span><span class="annot"><span class="annottext">MaryEraOnwards era
</span><a href="#local-6989586621679811565"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; TxOutValue era) -&gt; Value -&gt; TxOutValue era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679811560"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. IsCardanoEra era =&gt; CardanoEra era
</span><span class="hs-identifier hs-var">cardanoEra</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811377"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | `mkTxInModeCardano` never uses the `TxInByronSpecial` constructor</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- because its type enforces it being a Shelley-based era.</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Cardano.TxGenerator.Utils.html#mkTxInModeCardano"><span class="hs-identifier hs-type">mkTxInModeCardano</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679811388"><span class="annot"><a href="#local-6989586621679811388"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsShelleyBasedEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679811388"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679811388"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxInMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span>
</span><span id="line-91"></span><span id="mkTxInModeCardano"><span class="annot"><span class="annottext">mkTxInModeCardano :: forall era. IsShelleyBasedEra era =&gt; Tx era -&gt; TxInMode CardanoMode
</span><a href="Cardano.TxGenerator.Utils.html#mkTxInModeCardano"><span class="hs-identifier hs-var hs-var">mkTxInModeCardano</span></a></span></span><span> </span><span id="local-6989586621679811574"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679811574"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">Tx era -&gt; EraInMode era CardanoMode -&gt; TxInMode CardanoMode
forall era mode. Tx era -&gt; EraInMode era mode -&gt; TxInMode mode
</span><span class="hs-identifier hs-var">TxInMode</span></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679811574"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (EraInMode era CardanoMode) -&gt; EraInMode era CardanoMode
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (EraInMode era CardanoMode) -&gt; EraInMode era CardanoMode)
-&gt; Maybe (EraInMode era CardanoMode) -&gt; EraInMode era CardanoMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra era
-&gt; ConsensusMode CardanoMode -&gt; Maybe (EraInMode era CardanoMode)
forall era mode.
CardanoEra era -&gt; ConsensusMode mode -&gt; Maybe (EraInMode era mode)
</span><span class="hs-identifier hs-var">toEraInMode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. IsCardanoEra era =&gt; CardanoEra era
</span><span class="hs-identifier hs-var">cardanoEra</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679811388"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConsensusMode CardanoMode
</span><span class="hs-identifier hs-var">CardanoMode</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span></pre></body></html>