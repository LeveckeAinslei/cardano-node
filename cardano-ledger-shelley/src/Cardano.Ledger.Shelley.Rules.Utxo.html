<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Ledger.Shelley.Rules.Utxo</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier">ShelleyUTXO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier">UtxoEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEvent"><span class="hs-identifier">UtxoEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-identifier">PredicateFailure</span></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#updateUTxOState"><span class="hs-identifier">updateUTxOState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Validations</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateInputSetEmptyUTxO"><span class="hs-identifier">validateInputSetEmptyUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateFeeTooSmallUTxO"><span class="hs-identifier">validateFeeTooSmallUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateBadInputsUTxO"><span class="hs-identifier">validateBadInputsUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetwork"><span class="hs-identifier">validateWrongNetwork</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetworkWithdrawal"><span class="hs-identifier">validateWrongNetworkWithdrawal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputBootAddrAttrsTooBig"><span class="hs-identifier">validateOutputBootAddrAttrsTooBig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateMaxTxSizeUTxO"><span class="hs-identifier">validateMaxTxSizeUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateValueNotConservedUTxO"><span class="hs-identifier">validateValueNotConservedUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvSlotL"><span class="hs-identifier">utxoEnvSlotL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvPParamsL"><span class="hs-identifier">utxoEnvPParamsL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvCertStateL"><span class="hs-identifier">utxoEnvCertStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvGenDelegsL"><span class="hs-identifier">utxoEnvGenDelegsL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Address</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-identifier">Addr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-identifier">bootstrapAddressAttrsSize</span></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-identifier">getNetwork</span></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier">getRwdNetwork</span></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-identifier">Network</span></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-identifier">ShelleyBase</span></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-identifier">invalidKey</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="hs-identifier">networkId</span></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Binary</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="hs-identifier">DecCBOR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-identifier">EncCBOR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="hs-identifier">decodeRecordSum</span></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Coin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Coin</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Core</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GenDelegs</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Rules.ValidationMode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Inject</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Test</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runTest</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.SafeHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SafeHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hashAnnotated</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.AdaPots.html"><span class="hs-identifier">Cardano.Ledger.Shelley.AdaPots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.AdaPots.html#consumedTxBody"><span class="hs-identifier">consumedTxBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.AdaPots.html#producedTxBody"><span class="hs-identifier">producedTxBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyEra"><span class="hs-identifier">ShelleyEra</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier">ShelleyUTXO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Governance</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-identifier">CertState</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier">PPUPPredFailure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier">UTxOState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.RefundsAndDeposits.html#keyTxRefunds"><span class="hs-identifier">keyTxRefunds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.IncrementalStake.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState.IncrementalStake</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.PParams.html"><span class="hs-identifier">Cardano.Ledger.Shelley.PParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.PParams.html#Update"><span class="hs-identifier">Update</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Rules.Ppup</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PpupEnv"><span class="hs-identifier">PpupEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PpupEvent"><span class="hs-identifier">PpupEvent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyPPUP"><span class="hs-identifier">ShelleyPPUP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#ShelleyPpupPredFailure"><span class="hs-identifier">ShelleyPpupPredFailure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Reports.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Rules.Reports</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Reports.html#showTxCerts"><span class="hs-identifier">showTxCerts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Tx.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Tx.html#ShelleyTx"><span class="hs-identifier">ShelleyTx</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxIn</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.TxBody.html"><span class="hs-identifier">Cardano.Ledger.Shelley.TxBody</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="hs-identifier">RewardAcnt</span></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Core.html#ShelleyEraTxBody"><span class="hs-identifier">ShelleyEraTxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><span class="hs-identifier">Withdrawals</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.UTxO.html"><span class="hs-identifier">Cardano.Ledger.Shelley.UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.UTxO.html#consumed"><span class="hs-identifier">consumed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.UTxO.html#produced"><span class="hs-identifier">produced</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.UTxO.html#txup"><span class="hs-identifier">txup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotNo</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.TreeDiff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToExpr</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.UTxO</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="hs-identifier">EraUTxO</span></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="hs-identifier">balance</span></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="hs-identifier">txouts</span></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Val</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Val</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Reader.html"><span class="hs-identifier">Control.Monad.Trans.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Reader.html#asks"><span class="hs-identifier">asks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.State.Transition</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier">Assertion</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="hs-identifier">AssertionViolation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="hs-identifier">Embed</span></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="hs-identifier">STS</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="hs-identifier">TRC</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="hs-identifier">TransitionRule</span></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier">judgmentContext</span></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier">liftSTS</span></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier">tellEvent</span></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="hs-identifier">trans</span></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-identifier">wrapEvent</span></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="hs-identifier">wrapFailed</span></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.MapExtras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">extractKeys</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.Extras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Validation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">failureUnless</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">data</span><span> </span><span id="UtxoEnv"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-var">UtxoEnv</span></a></span></span><span> </span><span id="local-6989586621679616640"><span class="annot"><a href="#local-6989586621679616640"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UtxoEnv"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-var">UtxoEnv</span></a></span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ueSlot"><span class="annot"><span class="annottext">forall era. UtxoEnv era -&gt; SlotNo
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueSlot"><span class="hs-identifier hs-var hs-var">ueSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="uePParams"><span class="annot"><span class="annottext">forall era. UtxoEnv era -&gt; PParams era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#uePParams"><span class="hs-identifier hs-var hs-var">uePParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679616640"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ueCertState"><span class="annot"><span class="annottext">forall era. UtxoEnv era -&gt; CertState era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueCertState"><span class="hs-identifier hs-var hs-var">ueCertState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertState</span></span><span> </span><span class="annot"><a href="#local-6989586621679616640"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ueGenDelegs"><span class="annot"><span class="annottext">forall era. UtxoEnv era -&gt; GenDelegs (EraCrypto era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueGenDelegs"><span class="hs-identifier hs-var hs-var">ueGenDelegs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenDelegs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679616640"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679616652"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvSlotL"><span class="hs-identifier hs-type">utxoEnvSlotL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616652"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span></span><span>
</span><span id="line-136"></span><span id="utxoEnvSlotL"><span class="annot"><span class="annottext">utxoEnvSlotL :: forall era (f :: * -&gt; *).
Functor f =&gt;
(SlotNo -&gt; f SlotNo) -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvSlotL"><span class="hs-identifier hs-var hs-var">utxoEnvSlotL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UtxoEnv era -&gt; SlotNo)
-&gt; (UtxoEnv era -&gt; SlotNo -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (SlotNo -&gt; f SlotNo) -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">UtxoEnv era -&gt; SlotNo
forall era. UtxoEnv era -&gt; SlotNo
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueSlot"><span class="hs-identifier hs-var">ueSlot</span></a></span><span> </span><span class="annot"><span class="annottext">((UtxoEnv era -&gt; SlotNo -&gt; UtxoEnv era)
 -&gt; forall {f :: * -&gt; *}.
    Functor f =&gt;
    (SlotNo -&gt; f SlotNo) -&gt; UtxoEnv era -&gt; f (UtxoEnv era))
-&gt; (UtxoEnv era -&gt; SlotNo -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (SlotNo -&gt; f SlotNo) -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679617194"><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617194"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679617195"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617195"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617194"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueSlot"><span class="hs-identifier hs-var">ueSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679617195"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679616664"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvPParamsL"><span class="hs-identifier hs-type">utxoEnvPParamsL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616664"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679616664"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-139"></span><span id="utxoEnvPParamsL"><span class="annot"><span class="annottext">utxoEnvPParamsL :: forall era (f :: * -&gt; *).
Functor f =&gt;
(PParams era -&gt; f (PParams era)) -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvPParamsL"><span class="hs-identifier hs-var hs-var">utxoEnvPParamsL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UtxoEnv era -&gt; PParams era)
-&gt; (UtxoEnv era -&gt; PParams era -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (PParams era -&gt; f (PParams era)) -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">UtxoEnv era -&gt; PParams era
forall era. UtxoEnv era -&gt; PParams era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#uePParams"><span class="hs-identifier hs-var">uePParams</span></a></span><span> </span><span class="annot"><span class="annottext">((UtxoEnv era -&gt; PParams era -&gt; UtxoEnv era)
 -&gt; forall {f :: * -&gt; *}.
    Functor f =&gt;
    (PParams era -&gt; f (PParams era)) -&gt; UtxoEnv era -&gt; f (UtxoEnv era))
-&gt; (UtxoEnv era -&gt; PParams era -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (PParams era -&gt; f (PParams era)) -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679617198"><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617198"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679617199"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679617199"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617198"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#uePParams"><span class="hs-identifier hs-var">uePParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679617199"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679616668"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvCertStateL"><span class="hs-identifier hs-type">utxoEnvCertStateL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616668"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CertState</span></span><span> </span><span class="annot"><a href="#local-6989586621679616668"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-142"></span><span id="utxoEnvCertStateL"><span class="annot"><span class="annottext">utxoEnvCertStateL :: forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; UtxoEnv era -&gt; f (UtxoEnv era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvCertStateL"><span class="hs-identifier hs-var hs-var">utxoEnvCertStateL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UtxoEnv era -&gt; CertState era)
-&gt; (UtxoEnv era -&gt; CertState era -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (CertState era -&gt; f (CertState era))
   -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">UtxoEnv era -&gt; CertState era
forall era. UtxoEnv era -&gt; CertState era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueCertState"><span class="hs-identifier hs-var">ueCertState</span></a></span><span> </span><span class="annot"><span class="annottext">((UtxoEnv era -&gt; CertState era -&gt; UtxoEnv era)
 -&gt; forall {f :: * -&gt; *}.
    Functor f =&gt;
    (CertState era -&gt; f (CertState era))
    -&gt; UtxoEnv era -&gt; f (UtxoEnv era))
-&gt; (UtxoEnv era -&gt; CertState era -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (CertState era -&gt; f (CertState era))
   -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679617202"><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617202"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679617203"><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679617203"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617202"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueCertState"><span class="hs-identifier hs-var">ueCertState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679617203"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679616672"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvGenDelegsL"><span class="hs-identifier hs-type">utxoEnvGenDelegsL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616672"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GenDelegs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679616672"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-145"></span><span id="utxoEnvGenDelegsL"><span class="annot"><span class="annottext">utxoEnvGenDelegsL :: forall era (f :: * -&gt; *).
Functor f =&gt;
(GenDelegs (EraCrypto era) -&gt; f (GenDelegs (EraCrypto era)))
-&gt; UtxoEnv era -&gt; f (UtxoEnv era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoEnvGenDelegsL"><span class="hs-identifier hs-var hs-var">utxoEnvGenDelegsL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UtxoEnv era -&gt; GenDelegs (EraCrypto era))
-&gt; (UtxoEnv era -&gt; GenDelegs (EraCrypto era) -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (GenDelegs (EraCrypto era) -&gt; f (GenDelegs (EraCrypto era)))
   -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">UtxoEnv era -&gt; GenDelegs (EraCrypto era)
forall era. UtxoEnv era -&gt; GenDelegs (EraCrypto era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueGenDelegs"><span class="hs-identifier hs-var">ueGenDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">((UtxoEnv era -&gt; GenDelegs (EraCrypto era) -&gt; UtxoEnv era)
 -&gt; forall {f :: * -&gt; *}.
    Functor f =&gt;
    (GenDelegs (EraCrypto era) -&gt; f (GenDelegs (EraCrypto era)))
    -&gt; UtxoEnv era -&gt; f (UtxoEnv era))
-&gt; (UtxoEnv era -&gt; GenDelegs (EraCrypto era) -&gt; UtxoEnv era)
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (GenDelegs (EraCrypto era) -&gt; f (GenDelegs (EraCrypto era)))
   -&gt; UtxoEnv era -&gt; f (UtxoEnv era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679617206"><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617206"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679617207"><span class="annot"><span class="annottext">GenDelegs (EraCrypto era)
</span><a href="#local-6989586621679617207"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoEnv era
</span><a href="#local-6989586621679617206"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ueGenDelegs"><span class="hs-identifier hs-var">ueGenDelegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679617207"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679616681"><span id="local-6989586621679617210"><span id="local-6989586621679617221"><span id="local-6989586621679617225"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679616681"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616681"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="UtxoEvent"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEvent"><span class="hs-identifier hs-var">UtxoEvent</span></a></span></span><span> </span><span id="local-6989586621679617067"><span class="annot"><a href="#local-6989586621679617067"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TotalDeposits"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#TotalDeposits"><span class="hs-identifier hs-var">TotalDeposits</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SafeHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679617067"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraIndependentTxBody</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UpdateEvent"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateEvent"><span class="hs-identifier hs-var">UpdateEvent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679617067"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">data</span><span> </span><span id="ShelleyUtxoPredFailure"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-var">ShelleyUtxoPredFailure</span></a></span></span><span> </span><span id="local-6989586621679616826"><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BadInputsUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-var">BadInputsUTxO</span></a></span></span><span>
</span><span id="line-155"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The bad transaction inputs</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExpiredUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-var">ExpiredUTxO</span></a></span></span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-comment">-- transaction's time to live</span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-comment">-- current slot</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MaxTxSizeUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-var">MaxTxSizeUTxO</span></a></span></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- the actual transaction size</span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- the max transaction size</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InputSetEmptyUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FeeTooSmallUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-var">FeeTooSmallUTxO</span></a></span></span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span> </span><span class="hs-comment">-- the minimum fee for this transaction</span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span> </span><span class="hs-comment">-- the fee supplied in this transaction</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ValueNotConservedUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-var">ValueNotConservedUTxO</span></a></span></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the Coin consumed by this transaction</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the Coin produced by this transaction</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WrongNetwork"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetwork"><span class="hs-identifier hs-var">WrongNetwork</span></a></span></span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Network</span></span><span> </span><span class="hs-comment">-- the expected network id</span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Addr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the set of addresses with incorrect network IDs</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WrongNetworkWithdrawal"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-var">WrongNetworkWithdrawal</span></a></span></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Network</span></span><span> </span><span class="hs-comment">-- the expected network id</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RewardAcnt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the set of reward addresses with incorrect network IDs</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OutputTooSmallUTxO"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-var">OutputTooSmallUTxO</span></a></span></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of supplied transaction outputs that are too small</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UpdateFailure"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Subtransition Failures</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OutputBootAddrAttrsTooBig"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">OutputBootAddrAttrsTooBig</span></a></span></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616826"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of supplied bad transaction outputs</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679617242"><span id="local-6989586621679617244"><span class="annot"><span class="annottext">(forall x.
 ShelleyUtxoPredFailure era -&gt; Rep (ShelleyUtxoPredFailure era) x)
-&gt; (forall x.
    Rep (ShelleyUtxoPredFailure era) x -&gt; ShelleyUtxoPredFailure era)
-&gt; Generic (ShelleyUtxoPredFailure era)
forall x.
Rep (ShelleyUtxoPredFailure era) x -&gt; ShelleyUtxoPredFailure era
forall x.
ShelleyUtxoPredFailure era -&gt; Rep (ShelleyUtxoPredFailure era) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall era x.
Rep (ShelleyUtxoPredFailure era) x -&gt; ShelleyUtxoPredFailure era
forall era x.
ShelleyUtxoPredFailure era -&gt; Rep (ShelleyUtxoPredFailure era) x
$cfrom :: forall era x.
ShelleyUtxoPredFailure era -&gt; Rep (ShelleyUtxoPredFailure era) x
from :: forall x.
ShelleyUtxoPredFailure era -&gt; Rep (ShelleyUtxoPredFailure era) x
$cto :: forall era x.
Rep (ShelleyUtxoPredFailure era) x -&gt; ShelleyUtxoPredFailure era
to :: forall x.
Rep (ShelleyUtxoPredFailure era) x -&gt; ShelleyUtxoPredFailure era
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679617251"><span id="local-6989586621679617287"><span id="local-6989586621679617291"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679616703"><span class="annot"><a href="#local-6989586621679616703"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616703"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616703"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616703"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616703"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621679617300"><span id="local-6989586621679617327"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679616711"><span class="annot"><a href="#local-6989586621679616711"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616711"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616711"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616711"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616711"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679616757"><span id="local-6989586621679617338"><span id="local-6989586621679617342"><span id="local-6989586621679617348"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616757"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616757"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616757"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616757"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679616785"><span id="local-6989586621679617446"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Era</span></span><span> </span><span class="annot"><a href="#local-6989586621679616785"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616785"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616785"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616785"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616785"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679616791"><span id="local-6989586621679617542"><span id="local-6989586621679617546"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Era</span></span><span> </span><span class="annot"><a href="#local-6989586621679616791"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EncCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EncCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679617637"><span class="annot"><span class="annottext">encCBOR :: ShelleyUtxoPredFailure era -&gt; Encoding
</span><a href="#local-6989586621679617637"><span class="hs-identifier hs-var hs-var hs-var hs-var">encCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-type">BadInputsUTxO</span></a></span><span> </span><span id="local-6989586621679617639"><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679617639"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era)) -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679617639"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-type">ExpiredUTxO</span></a></span><span> </span><span id="local-6989586621679617640"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617640"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679617641"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617641"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617640"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617641"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-type">MaxTxSizeUTxO</span></a></span><span> </span><span id="local-6989586621679617642"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617642"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679617643"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617643"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617642"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617643"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-type">FeeTooSmallUTxO</span></a></span><span> </span><span id="local-6989586621679617644"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617644"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679617645"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617645"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617644"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617645"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-type">ValueNotConservedUTxO</span></a></span><span> </span><span id="local-6989586621679617646"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617646"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679617647"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617647"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617646"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617647"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-type">OutputTooSmallUTxO</span></a></span><span> </span><span id="local-6989586621679617648"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617648"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-245"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617648"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateFailure"><span class="hs-identifier hs-type">UpdateFailure</span></a></span><span> </span><span id="local-6989586621679617649"><span class="annot"><span class="annottext">PPUPPredFailure era
</span><a href="#local-6989586621679617649"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PPUPPredFailure era -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">PPUPPredFailure era
</span><a href="#local-6989586621679617649"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetwork"><span class="hs-identifier hs-type">WrongNetwork</span></a></span><span> </span><span id="local-6989586621679617650"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617650"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span id="local-6989586621679617651"><span class="annot"><span class="annottext">Set (Addr (EraCrypto era))
</span><a href="#local-6989586621679617651"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617650"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Addr (EraCrypto era)) -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Set (Addr (EraCrypto era))
</span><a href="#local-6989586621679617651"><span class="hs-identifier hs-var">wrongs</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-type">WrongNetworkWithdrawal</span></a></span><span> </span><span id="local-6989586621679617652"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617652"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span id="local-6989586621679617653"><span class="annot"><span class="annottext">Set (RewardAcnt (EraCrypto era))
</span><a href="#local-6989586621679617653"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617652"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set (RewardAcnt (EraCrypto era)) -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">Set (RewardAcnt (EraCrypto era))
</span><a href="#local-6989586621679617653"><span class="hs-identifier hs-var">wrongs</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-type">OutputBootAddrAttrsTooBig</span></a></span><span> </span><span id="local-6989586621679617654"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617654"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encCBOR</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617654"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679616812"><span id="local-6989586621679617663"><span id="local-6989586621679617667"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraTxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616812"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616812"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">DecCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616812"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679617765"><span class="annot"><span class="annottext">decCBOR :: forall s. Decoder s (ShelleyUtxoPredFailure era)
</span><a href="#local-6989586621679617765"><span class="hs-identifier hs-var hs-var hs-var hs-var">decCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="annottext">String
-&gt; (Word -&gt; Decoder s (Int, ShelleyUtxoPredFailure era))
-&gt; Decoder s (ShelleyUtxoPredFailure era)
forall s a. String -&gt; (Word -&gt; Decoder s (Int, a)) -&gt; Decoder s a
</span><span class="hs-identifier hs-var">decodeRecordSum</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PredicateFailureUTXO&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Word -&gt; Decoder s (Int, ShelleyUtxoPredFailure era))
 -&gt; Decoder s (ShelleyUtxoPredFailure era))
-&gt; (Word -&gt; Decoder s (Int, ShelleyUtxoPredFailure era))
-&gt; Decoder s (ShelleyUtxoPredFailure era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>          </span><span id="local-6989586621679617767"><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679617767"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Set (TxIn (EraCrypto era)))
forall s. Decoder s (Set (TxIn (EraCrypto era)))
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-277"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
forall era.
Set (TxIn (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-var">BadInputsUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679617767"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The (2,..) indicates the number of things decoded, INCLUDING the tags, which are decoded by decodeRecordSumNamed</span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>          </span><span id="local-6989586621679617768"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617768"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s SlotNo
forall s. Decoder s SlotNo
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-280"></span><span>          </span><span id="local-6989586621679617769"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617769"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s SlotNo
forall s. Decoder s SlotNo
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; ShelleyUtxoPredFailure era
forall era. SlotNo -&gt; SlotNo -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-var">ExpiredUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617768"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679617769"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>          </span><span id="local-6989586621679617770"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617770"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Integer
forall s. Decoder s Integer
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-284"></span><span>          </span><span id="local-6989586621679617771"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617771"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Integer
forall s. Decoder s Integer
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-285"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; ShelleyUtxoPredFailure era
forall era. Integer -&gt; Integer -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-var">MaxTxSizeUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617770"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679617771"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShelleyUtxoPredFailure era
forall era. ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>          </span><span id="local-6989586621679617772"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617772"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Coin
forall s. Decoder s Coin
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-289"></span><span>          </span><span id="local-6989586621679617773"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617773"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Coin
forall s. Decoder s Coin
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; ShelleyUtxoPredFailure era
forall era. Coin -&gt; Coin -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-var">FeeTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617772"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679617773"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>          </span><span id="local-6989586621679617774"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617774"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Value era)
forall s. Decoder s (Value era)
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-293"></span><span>          </span><span id="local-6989586621679617775"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617775"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Value era)
forall s. Decoder s (Value era)
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-294"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; ShelleyUtxoPredFailure era
forall era. Value era -&gt; Value era -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-var">ValueNotConservedUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617774"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679617775"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>          </span><span id="local-6989586621679617776"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617776"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s [TxOut era]
forall s. Decoder s [TxOut era]
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-297"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; ShelleyUtxoPredFailure era
forall era. [TxOut era] -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-var">OutputTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617776"><span class="hs-identifier hs-var">outs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>          </span><span id="local-6989586621679617777"><span class="annot"><span class="annottext">PPUPPredFailure era
</span><a href="#local-6989586621679617777"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (PPUPPredFailure era)
forall s. Decoder s (PPUPPredFailure era)
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-300"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PPUPPredFailure era -&gt; ShelleyUtxoPredFailure era
forall era. PPUPPredFailure era -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span><span> </span><span class="annot"><span class="annottext">PPUPPredFailure era
</span><a href="#local-6989586621679617777"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>          </span><span id="local-6989586621679617778"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617778"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Network
forall s. Decoder s Network
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-303"></span><span>          </span><span id="local-6989586621679617779"><span class="annot"><span class="annottext">Set (Addr (EraCrypto era))
</span><a href="#local-6989586621679617779"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Set (Addr (EraCrypto era)))
forall s. Decoder s (Set (Addr (EraCrypto era)))
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-304"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Set (Addr (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
forall era.
Network -&gt; Set (Addr (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetwork"><span class="hs-identifier hs-var">WrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617778"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Addr (EraCrypto era))
</span><a href="#local-6989586621679617779"><span class="hs-identifier hs-var">wrongs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>          </span><span id="local-6989586621679617780"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617780"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s Network
forall s. Decoder s Network
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-307"></span><span>          </span><span id="local-6989586621679617781"><span class="annot"><span class="annottext">Set (RewardAcnt (EraCrypto era))
</span><a href="#local-6989586621679617781"><span class="hs-identifier hs-var">wrongs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Set (RewardAcnt (EraCrypto era)))
forall s. Decoder s (Set (RewardAcnt (EraCrypto era)))
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-308"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
-&gt; Set (RewardAcnt (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
forall era.
Network
-&gt; Set (RewardAcnt (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-var">WrongNetworkWithdrawal</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679617780"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Set (RewardAcnt (EraCrypto era))
</span><a href="#local-6989586621679617781"><span class="hs-identifier hs-var">wrongs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-310"></span><span>          </span><span id="local-6989586621679617782"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617782"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s [TxOut era]
forall s. Decoder s [TxOut era]
forall a s. DecCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decCBOR</span></span><span>
</span><span id="line-311"></span><span>          </span><span class="annot"><span class="annottext">(Int, ShelleyUtxoPredFailure era)
-&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; ShelleyUtxoPredFailure era
forall era. [TxOut era] -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">OutputBootAddrAttrsTooBig</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679617782"><span class="hs-identifier hs-var">outs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>        </span><span id="local-6989586621679617783"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679617783"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Decoder s (Int, ShelleyUtxoPredFailure era)
forall (m :: * -&gt; *) a. MonadFail m =&gt; Word -&gt; m a
</span><span class="hs-identifier hs-var">invalidKey</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679617783"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679616866"><span id="local-6989586621679617788"><span id="local-6989586621679617795"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616866"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616866"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679616866"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ToExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616866"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679616929"><span id="local-6989586621679617947"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraTx</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraUTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Core.html#ShelleyEraTxBody"><span class="hs-identifier hs-type">ShelleyEraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#EraGov"><span class="hs-identifier hs-type">EraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#GovState"><span class="hs-identifier hs-type">GovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#ShelleyGovState"><span class="hs-identifier hs-type">ShelleyGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExactEra</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Tx.html#ShelleyTx"><span class="hs-identifier hs-type">ShelleyTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Tx.html#ShelleyTx"><span class="hs-identifier hs-type">ShelleyTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Embed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PpupEnv"><span class="hs-identifier hs-type">PpupEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.PParams.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#ShelleyGovState"><span class="hs-identifier hs-type">ShelleyGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtVerAtMost</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">STS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="State"><span class="annot"><span class="hs-identifier hs-var">State</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Signal"><span class="annot"><span class="hs-identifier hs-var">Signal</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Tx.html#ShelleyTx"><span class="hs-identifier hs-type">ShelleyTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Environment"><span class="annot"><span class="hs-identifier hs-var">Environment</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BaseM"><span class="annot"><span class="hs-identifier hs-var">BaseM</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyBase</span></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PredicateFailure"><span class="annot"><span class="hs-identifier hs-var">PredicateFailure</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Event"><span class="annot"><span class="hs-identifier hs-var">Event</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEvent"><span class="hs-identifier hs-type">UtxoEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621679618053"><span class="annot"><span class="annottext">transitionRules :: [TransitionRule (ShelleyUTXO era)]
</span><a href="#local-6989586621679618053"><span class="hs-identifier hs-var hs-var hs-var hs-var">transitionRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TransitionRule (ShelleyUTXO era)
forall era (utxo :: * -&gt; *).
(EraUTxO era, ShelleyEraTxBody era, ExactEra ShelleyEra era,
 STS (utxo era), Embed (EraRule &quot;PPUP&quot; era) (utxo era),
 BaseM (utxo era) ~ ShelleyBase,
 Environment (utxo era) ~ UtxoEnv era,
 State (utxo era) ~ UTxOState era, Signal (utxo era) ~ Tx era,
 PredicateFailure (utxo era) ~ ShelleyUtxoPredFailure era,
 Event (utxo era) ~ UtxoEvent era,
 Environment (EraRule &quot;PPUP&quot; era) ~ PpupEnv era,
 State (EraRule &quot;PPUP&quot; era) ~ ShelleyGovState era,
 Signal (EraRule &quot;PPUP&quot; era) ~ Maybe (Update era),
 ProtVerAtMost era 8, GovState era ~ ShelleyGovState era) =&gt;
TransitionRule (utxo era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoInductive"><span class="hs-identifier hs-var">utxoInductive</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679618096"><span class="annot"><span class="annottext">renderAssertionViolation :: AssertionViolation (ShelleyUTXO era) -&gt; String
</span><a href="#local-6989586621679618096"><span class="hs-identifier hs-var hs-var hs-var hs-var">renderAssertionViolation</span></a></span></span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">AssertionViolation</span></span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679618099"><span class="annot"><span class="annottext">String
avSTS :: String
avSTS :: forall sts. AssertionViolation sts -&gt; String
</span><a href="#local-6989586621679618099"><span class="hs-identifier hs-var hs-var">avSTS</span></a></span></span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618101"><span class="annot"><span class="annottext">String
avMsg :: String
avMsg :: forall sts. AssertionViolation sts -&gt; String
</span><a href="#local-6989586621679618101"><span class="hs-identifier hs-var hs-var">avMsg</span></a></span></span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">avCtx :: forall sts. AssertionViolation sts -&gt; TRC sts
</span><span class="hs-identifier hs-var">avCtx</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TRC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span id="local-6989586621679618105"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618105"><span class="hs-identifier hs-var">_slot</span></a></span></span><span> </span><span id="local-6989586621679618106"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618106"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679618107"><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618107"><span class="hs-identifier hs-var">dpstate</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenDelegs (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679618109"><span class="annot"><span class="annottext">Coin
utxosDeposited :: Coin
utxosDeposited :: forall era. UTxOState era -&gt; Coin
</span><a href="#local-6989586621679618109"><span class="hs-identifier hs-var hs-var">utxosDeposited</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618111"><span class="annot"><span class="annottext">UTxO era
utxosUtxo :: UTxO era
utxosUtxo :: forall era. UTxOState era -&gt; UTxO era
</span><a href="#local-6989586621679618111"><span class="hs-identifier hs-var hs-var">utxosUtxo</span></a></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618113"><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
</span><a href="#local-6989586621679618113"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AssertionViolation (&quot;</span></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679618099"><span class="hs-identifier hs-var">avSTS</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;): &quot;</span></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679618101"><span class="hs-identifier hs-var">avMsg</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n PParams\n&quot;</span></span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618106"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n Certs\n&quot;</span></span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; String
forall era. ShelleyEraTxBody era =&gt; TxBody era -&gt; String
</span><a href="Cardano.Ledger.Shelley.Rules.Reports.html#showTxCerts"><span class="hs-identifier hs-var">showTxCerts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
ShelleyTx era
</span><a href="#local-6989586621679618113"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyTx era
-&gt; Getting (TxBody era) (ShelleyTx era) (TxBody era) -&gt; TxBody era
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(TxBody era -&gt; Const (TxBody era) (TxBody era))
-&gt; Tx era -&gt; Const (TxBody era) (Tx era)
Getting (TxBody era) (ShelleyTx era) (TxBody era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxBody era)
Lens' (Tx era) (TxBody era)
</span><span class="hs-identifier hs-var">bodyTxL</span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n Deposits\n&quot;</span></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618109"><span class="hs-identifier hs-var">utxosDeposited</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n Consumed\n&quot;</span></span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Consumed -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; PParams era -&gt; CertState era -&gt; UTxO era -&gt; Consumed
forall era.
ShelleyEraTxBody era =&gt;
TxBody era -&gt; PParams era -&gt; CertState era -&gt; UTxO era -&gt; Consumed
</span><a href="Cardano.Ledger.Shelley.AdaPots.html#consumedTxBody"><span class="hs-identifier hs-var">consumedTxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
ShelleyTx era
</span><a href="#local-6989586621679618113"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyTx era
-&gt; Getting (TxBody era) (ShelleyTx era) (TxBody era) -&gt; TxBody era
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(TxBody era -&gt; Const (TxBody era) (TxBody era))
-&gt; Tx era -&gt; Const (TxBody era) (Tx era)
Getting (TxBody era) (ShelleyTx era) (TxBody era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxBody era)
Lens' (Tx era) (TxBody era)
</span><span class="hs-identifier hs-var">bodyTxL</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618106"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618107"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618111"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n Produced\n&quot;</span></span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Produced -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; PParams era -&gt; CertState era -&gt; Produced
forall era.
ShelleyEraTxBody era =&gt;
TxBody era -&gt; PParams era -&gt; CertState era -&gt; Produced
</span><a href="Cardano.Ledger.Shelley.AdaPots.html#producedTxBody"><span class="hs-identifier hs-var">producedTxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
ShelleyTx era
</span><a href="#local-6989586621679618113"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyTx era
-&gt; Getting (TxBody era) (ShelleyTx era) (TxBody era) -&gt; TxBody era
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(TxBody era -&gt; Const (TxBody era) (TxBody era))
-&gt; Tx era -&gt; Const (TxBody era) (Tx era)
Getting (TxBody era) (ShelleyTx era) (TxBody era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxBody era)
Lens' (Tx era) (TxBody era)
</span><span class="hs-identifier hs-var">bodyTxL</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618106"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618107"><span class="hs-identifier hs-var">dpstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679618144"><span class="annot"><span class="annottext">assertions :: [Assertion (ShelleyUTXO era)]
</span><a href="#local-6989586621679618144"><span class="hs-identifier hs-var hs-var hs-var hs-var">assertions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TRC (ShelleyUTXO era) -&gt; Bool) -&gt; Assertion (ShelleyUTXO era)
forall sts. String -&gt; (TRC sts -&gt; Bool) -&gt; Assertion sts
</span><span class="hs-identifier hs-var">PreCondition</span></span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Deposit pot must not be negative (pre)&quot;</span></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment (ShelleyUTXO era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618147"><span class="annot"><span class="annottext">State (ShelleyUTXO era)
</span><a href="#local-6989586621679618147"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosDeposited"><span class="hs-identifier hs-var">utxosDeposited</span></a></span><span> </span><span class="annot"><span class="annottext">State (ShelleyUTXO era)
UTxOState era
</span><a href="#local-6989586621679618147"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TRC (ShelleyUTXO era) -&gt; State (ShelleyUTXO era) -&gt; Bool)
-&gt; Assertion (ShelleyUTXO era)
forall sts.
String -&gt; (TRC sts -&gt; State sts -&gt; Bool) -&gt; Assertion sts
</span><span class="hs-identifier hs-var">PostCondition</span></span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UTxO must increase fee pot&quot;</span></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment (ShelleyUTXO era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618149"><span class="annot"><span class="annottext">State (ShelleyUTXO era)
</span><a href="#local-6989586621679618149"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679618150"><span class="annot"><span class="annottext">State (ShelleyUTXO era)
</span><a href="#local-6989586621679618150"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosFees"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="annot"><span class="annottext">State (ShelleyUTXO era)
UTxOState era
</span><a href="#local-6989586621679618150"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosFees"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="annot"><span class="annottext">State (ShelleyUTXO era)
UTxOState era
</span><a href="#local-6989586621679618149"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TRC (ShelleyUTXO era) -&gt; State (ShelleyUTXO era) -&gt; Bool)
-&gt; Assertion (ShelleyUTXO era)
forall sts.
String -&gt; (TRC sts -&gt; State sts -&gt; Bool) -&gt; Assertion sts
</span><span class="hs-identifier hs-var">PostCondition</span></span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Deposit pot must not be negative (post)&quot;</span></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TRC (ShelleyUTXO era)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679618152"><span class="annot"><span class="annottext">State (ShelleyUTXO era)
</span><a href="#local-6989586621679618152"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosDeposited"><span class="hs-identifier hs-var">utxosDeposited</span></a></span><span> </span><span class="annot"><span class="annottext">State (ShelleyUTXO era)
UTxOState era
</span><a href="#local-6989586621679618152"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679618538"><span class="annot"><span class="annottext">utxoBalance :: UTxOState era -&gt; Value era
</span><a href="#local-6989586621679618538"><span class="hs-identifier hs-var hs-var">utxoBalance</span></a></span></span><span> </span><span id="local-6989586621679618539"><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621679618539"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t. Val t =&gt; Coin -&gt; t
</span><span class="hs-identifier hs-var">Val.inject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosDeposited"><span class="hs-identifier hs-var">utxosDeposited</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621679618539"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Coin
forall era. UTxOState era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosFees"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621679618539"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Value era
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Value era
forall era. EraTxOut era =&gt; UTxO era -&gt; Value era
</span><span class="hs-identifier hs-var">balance</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxOState era -&gt; UTxO era
forall era. UTxOState era -&gt; UTxO era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosUtxo"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621679618539"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>          </span><span class="annot"><a href="#local-6989586621679618541"><span class="hs-identifier hs-type">withdrawals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><a href="#local-6989586621679616929"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-382"></span><span>          </span><span id="local-6989586621679618541"><span class="annot"><span class="annottext">withdrawals :: TxBody era -&gt; Value era
</span><a href="#local-6989586621679618541"><span class="hs-identifier hs-var hs-var">withdrawals</span></a></span></span><span> </span><span id="local-6989586621679618542"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618542"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t. Val t =&gt; Coin -&gt; t
</span><span class="hs-identifier hs-var">Val.inject</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Value era) -&gt; Coin -&gt; Value era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Coin -&gt; Coin)
-&gt; Coin -&gt; Map (RewardAcnt (EraCrypto era)) Coin -&gt; Coin
forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; Map (RewardAcnt (EraCrypto era)) a -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (RewardAcnt (EraCrypto era)) Coin -&gt; Coin)
-&gt; Map (RewardAcnt (EraCrypto era)) Coin -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Withdrawals (EraCrypto era)
-&gt; Map (RewardAcnt (EraCrypto era)) Coin
forall c. Withdrawals c -&gt; Map (RewardAcnt c) Coin
</span><span class="hs-identifier hs-var">unWithdrawals</span></span><span> </span><span class="annot"><span class="annottext">(Withdrawals (EraCrypto era)
 -&gt; Map (RewardAcnt (EraCrypto era)) Coin)
-&gt; Withdrawals (EraCrypto era)
-&gt; Map (RewardAcnt (EraCrypto era)) Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618542"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Getting
     (Withdrawals (EraCrypto era))
     (TxBody era)
     (Withdrawals (EraCrypto era))
-&gt; Withdrawals (EraCrypto era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Withdrawals (EraCrypto era))
  (TxBody era)
  (Withdrawals (EraCrypto era))
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (Withdrawals (EraCrypto era))
Lens' (TxBody era) (Withdrawals (EraCrypto era))
</span><span class="hs-identifier hs-var">withdrawalsTxBodyL</span></span><span>
</span><span id="line-383"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TRC (ShelleyUTXO era) -&gt; State (ShelleyUTXO era) -&gt; Bool)
-&gt; Assertion (ShelleyUTXO era)
forall sts.
String -&gt; (TRC sts -&gt; State sts -&gt; Bool) -&gt; Assertion sts
</span><span class="hs-identifier hs-var">PostCondition</span></span><span>
</span><span id="line-384"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Should preserve value in the UTxO state&quot;</span></span><span>
</span><span id="line-385"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679618545"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618545"><span class="hs-identifier hs-var">_pp</span></a></span></span><span> </span><span id="local-6989586621679618546"><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618546"><span class="hs-identifier hs-var">_pools</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenDelegs (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618547"><span class="annot"><span class="annottext">State (ShelleyUTXO era)
</span><a href="#local-6989586621679618547"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618548"><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
</span><a href="#local-6989586621679618548"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679618549"><span class="annot"><span class="annottext">State (ShelleyUTXO era)
</span><a href="#local-6989586621679618549"><span class="hs-identifier hs-var">us'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>                </span><span class="annot"><span class="annottext">UTxOState era -&gt; Value era
forall {era}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 EraTxOut era) =&gt;
UTxOState era -&gt; Value era
</span><a href="#local-6989586621679618538"><span class="hs-identifier hs-var">utxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">State (ShelleyUTXO era)
UTxOState era
</span><a href="#local-6989586621679618547"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Value era
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Value era
</span><a href="#local-6989586621679618541"><span class="hs-identifier hs-var">withdrawals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signal (ShelleyUTXO era)
ShelleyTx era
</span><a href="#local-6989586621679618548"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyTx era
-&gt; Getting (TxBody era) (ShelleyTx era) (TxBody era) -&gt; TxBody era
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(TxBody era -&gt; Const (TxBody era) (TxBody era))
-&gt; Tx era -&gt; Const (TxBody era) (Tx era)
Getting (TxBody era) (ShelleyTx era) (TxBody era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxBody era)
Lens' (Tx era) (TxBody era)
</span><span class="hs-identifier hs-var">bodyTxL</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; Value era
forall {era}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 EraTxOut era) =&gt;
UTxOState era -&gt; Value era
</span><a href="#local-6989586621679618538"><span class="hs-identifier hs-var">utxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">State (ShelleyUTXO era)
UTxOState era
</span><a href="#local-6989586621679618549"><span class="hs-identifier hs-var">us'</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoInductive"><span class="hs-identifier hs-type">utxoInductive</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679616932"><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679616933"><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraUTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Core.html#ShelleyEraTxBody"><span class="hs-identifier hs-type">ShelleyEraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExactEra</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Embed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BaseM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyBase</span></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PredicateFailure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEvent"><span class="hs-identifier hs-type">UtxoEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PpupEnv"><span class="hs-identifier hs-type">PpupEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#ShelleyGovState"><span class="hs-identifier hs-type">ShelleyGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.PParams.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtVerAtMost</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#GovState"><span class="hs-identifier hs-type">GovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#ShelleyGovState"><span class="hs-identifier hs-type">ShelleyGovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TransitionRule</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679616933"><span class="hs-identifier hs-type">utxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span id="utxoInductive"><span class="annot"><span class="annottext">utxoInductive :: forall era (utxo :: * -&gt; *).
(EraUTxO era, ShelleyEraTxBody era, ExactEra ShelleyEra era,
 STS (utxo era), Embed (EraRule &quot;PPUP&quot; era) (utxo era),
 BaseM (utxo era) ~ ShelleyBase,
 Environment (utxo era) ~ UtxoEnv era,
 State (utxo era) ~ UTxOState era, Signal (utxo era) ~ Tx era,
 PredicateFailure (utxo era) ~ ShelleyUtxoPredFailure era,
 Event (utxo era) ~ UtxoEvent era,
 Environment (EraRule &quot;PPUP&quot; era) ~ PpupEnv era,
 State (EraRule &quot;PPUP&quot; era) ~ ShelleyGovState era,
 Signal (EraRule &quot;PPUP&quot; era) ~ Maybe (Update era),
 ProtVerAtMost era 8, GovState era ~ ShelleyGovState era) =&gt;
TransitionRule (utxo era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#utxoInductive"><span class="hs-identifier hs-var hs-var">utxoInductive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TRC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UtxoEnv"><span class="hs-identifier hs-type">UtxoEnv</span></a></span><span> </span><span id="local-6989586621679618653"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618653"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span id="local-6989586621679618654"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679618655"><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618655"><span class="hs-identifier hs-var">dpstate</span></a></span></span><span> </span><span id="local-6989586621679618656"><span class="annot"><span class="annottext">GenDelegs (EraCrypto era)
</span><a href="#local-6989586621679618656"><span class="hs-identifier hs-var">genDelegs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618657"><span class="annot"><span class="annottext">State (utxo era)
</span><a href="#local-6989586621679618657"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618658"><span class="annot"><span class="annottext">Signal (utxo era)
</span><a href="#local-6989586621679618658"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rule (utxo era) 'Transition (RuleContext 'Transition (utxo era))
F (Clause (utxo era) 'Transition) (TRC (utxo era))
forall sts (rtype :: RuleType).
Rule sts rtype (RuleContext rtype sts)
</span><span class="hs-identifier hs-var">judgmentContext</span></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span id="local-6989586621679618659"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618659"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679618660"><span class="annot"><span class="annottext">GovState era
</span><a href="#local-6989586621679618660"><span class="hs-identifier hs-var">ppup</span></a></span></span><span> </span><span class="annot"><span class="annottext">IncrementalStake (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (utxo era)
</span><a href="#local-6989586621679618657"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span id="local-6989586621679618661"><span class="annot"><span class="annottext">txBody :: TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx era
Signal (utxo era)
</span><a href="#local-6989586621679618658"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Getting (TxBody era) (Tx era) (TxBody era) -&gt; TxBody era
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (TxBody era) (Tx era) (TxBody era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxBody era)
Lens' (Tx era) (TxBody era)
</span><span class="hs-identifier hs-var">bodyTxL</span></span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621679618662"><span class="annot"><span class="annottext">outputs :: StrictSeq (TxOut era)
</span><a href="#local-6989586621679618662"><span class="hs-identifier hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Getting
     (StrictSeq (TxOut era)) (TxBody era) (StrictSeq (TxOut era))
-&gt; StrictSeq (TxOut era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (StrictSeq (TxOut era)) (TxBody era) (StrictSeq (TxOut era))
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (StrictSeq (TxOut era))
Lens' (TxBody era) (StrictSeq (TxOut era))
</span><span class="hs-identifier hs-var">outputsTxBodyL</span></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-comment">{- txttl txb &#8805; slot -}</span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; SlotNo -&gt; Test (ShelleyUtxoPredFailure era)
forall era.
(ShelleyEraTxBody era, ExactEra ShelleyEra era) =&gt;
TxBody era -&gt; SlotNo -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateTimeToLive"><span class="hs-identifier hs-var">validateTimeToLive</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618653"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-comment">{- txins txb &#8800; &#8709; -}</span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Test (ShelleyUtxoPredFailure era)
forall era.
EraTxBody era =&gt;
TxBody era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateInputSetEmptyUTxO"><span class="hs-identifier hs-var">validateInputSetEmptyUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-comment">{- minfee pp tx &#8804; txfee txb -}</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Tx era -&gt; Test (ShelleyUtxoPredFailure era)
forall era.
EraTx era =&gt;
PParams era -&gt; Tx era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateFeeTooSmallUTxO"><span class="hs-identifier hs-var">validateFeeTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
Signal (utxo era)
</span><a href="#local-6989586621679618658"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-comment">{- txins txb &#8838; dom utxo -}</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
-&gt; Set (TxIn (EraCrypto era)) -&gt; Test (ShelleyUtxoPredFailure era)
forall era.
UTxO era
-&gt; Set (TxIn (EraCrypto era)) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateBadInputsUTxO"><span class="hs-identifier hs-var">validateBadInputsUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618659"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">(Set (TxIn (EraCrypto era)) -&gt; Test (ShelleyUtxoPredFailure era))
-&gt; Set (TxIn (EraCrypto era)) -&gt; Test (ShelleyUtxoPredFailure era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Getting
     (Set (TxIn (EraCrypto era)))
     (TxBody era)
     (Set (TxIn (EraCrypto era)))
-&gt; Set (TxIn (EraCrypto era))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Set (TxIn (EraCrypto era)))
  (TxBody era)
  (Set (TxIn (EraCrypto era)))
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (Set (TxIn (EraCrypto era)))
Lens' (TxBody era) (Set (TxIn (EraCrypto era)))
</span><span class="hs-identifier hs-var">inputsTxBodyL</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621679618666"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618666"><span class="hs-identifier hs-var">netId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BaseM (utxo era) Network -&gt; Rule (utxo era) 'Transition Network
forall sts a (ctx :: RuleType).
STS sts =&gt;
BaseM sts a -&gt; Rule sts ctx a
</span><span class="hs-identifier hs-var">liftSTS</span></span><span> </span><span class="annot"><span class="annottext">(BaseM (utxo era) Network -&gt; Rule (utxo era) 'Transition Network)
-&gt; BaseM (utxo era) Network -&gt; Rule (utxo era) 'Transition Network
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Globals -&gt; Network) -&gt; ReaderT Globals Identity Network
forall (m :: * -&gt; *) r a. Monad m =&gt; (r -&gt; a) -&gt; ReaderT r m a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Reader.html#asks"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">Globals -&gt; Network
</span><span class="hs-identifier hs-var">networkId</span></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-comment">{- &#8704;(_ &#8594; (a, _)) &#8712; txouts txb, netId a = NetworkId -}</span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Network
-&gt; StrictSeq (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
forall era (f :: * -&gt; *).
(EraTxOut era, Foldable f) =&gt;
Network -&gt; f (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetwork"><span class="hs-identifier hs-var">validateWrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618666"><span class="hs-identifier hs-var">netId</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (TxOut era)
</span><a href="#local-6989586621679618662"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-comment">{- &#8704;(a &#8594; ) &#8712; txwdrls txb, netId a = NetworkId -}</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; TxBody era -&gt; Test (ShelleyUtxoPredFailure era)
forall era.
ShelleyEraTxBody era =&gt;
Network -&gt; TxBody era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetworkWithdrawal"><span class="hs-identifier hs-var">validateWrongNetworkWithdrawal</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618666"><span class="hs-identifier hs-var">netId</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-comment">{- consumed pp utxo txb = produced pp poolParams txb -}</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; UTxO era
-&gt; CertState era
-&gt; TxBody era
-&gt; Test (ShelleyUtxoPredFailure era)
forall era.
(ShelleyEraTxBody era, EraUTxO era) =&gt;
PParams era
-&gt; UTxO era
-&gt; CertState era
-&gt; TxBody era
-&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateValueNotConservedUTxO"><span class="hs-identifier hs-var">validateValueNotConservedUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618659"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618655"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-comment">-- process Protocol Parameter Update Proposals</span><span>
</span><span id="line-440"></span><span>  </span><span id="local-6989586621679618667"><span class="annot"><span class="annottext">ShelleyGovState era
</span><a href="#local-6989586621679618667"><span class="hs-identifier hs-var">ppup'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall sub super (rtype :: RuleType).
Embed sub super =&gt;
RuleContext rtype sub -&gt; Rule super rtype (State sub)
</span><span class="hs-identifier hs-var">trans</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679616932"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RuleContext 'Transition (EraRule &quot;PPUP&quot; era)
 -&gt; Rule (utxo era) 'Transition (State (EraRule &quot;PPUP&quot; era)))
-&gt; RuleContext 'Transition (EraRule &quot;PPUP&quot; era)
-&gt; Rule (utxo era) 'Transition (State (EraRule &quot;PPUP&quot; era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Environment (EraRule &quot;PPUP&quot; era), State (EraRule &quot;PPUP&quot; era),
 Signal (EraRule &quot;PPUP&quot; era))
-&gt; TRC (EraRule &quot;PPUP&quot; era)
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><span class="hs-identifier hs-var">TRC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; PParams era -&gt; GenDelegs (EraCrypto era) -&gt; PpupEnv era
forall era.
SlotNo -&gt; PParams era -&gt; GenDelegs (EraCrypto era) -&gt; PpupEnv era
</span><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPEnv"><span class="hs-identifier hs-var">PPUPEnv</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618653"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">GenDelegs (EraCrypto era)
</span><a href="#local-6989586621679618656"><span class="hs-identifier hs-var">genDelegs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GovState era
State (EraRule &quot;PPUP&quot; era)
</span><a href="#local-6989586621679618660"><span class="hs-identifier hs-var">ppup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Maybe (Update era)
forall era.
(EraTx era, ShelleyEraTxBody era, ProtVerAtMost era 8) =&gt;
Tx era -&gt; Maybe (Update era)
</span><a href="Cardano.Ledger.Shelley.UTxO.html#txup"><span class="hs-identifier hs-var">txup</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
Signal (utxo era)
</span><a href="#local-6989586621679618658"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-comment">{- &#8704;(_ &#8594; (_, c)) &#8712; txouts txb, c &#8805; (minUTxOValue pp) -}</span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; StrictSeq (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
forall era (f :: * -&gt; *).
(EraTxOut era, Foldable f) =&gt;
PParams era -&gt; f (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputTooSmallUTxO"><span class="hs-identifier hs-var">validateOutputTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (TxOut era)
</span><a href="#local-6989586621679618662"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-comment">{- &#8704; ( _ &#8614; (a,_)) &#8712; txoutstxb,  a &#8712; Addrbootstrap &#8594; bootstrapAttrsSize a &#8804; 64 -}</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
forall era (f :: * -&gt; *).
(EraTxOut era, Foldable f) =&gt;
f (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">validateOutputBootAddrAttrsTooBig</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (TxOut era)
</span><a href="#local-6989586621679618662"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-comment">{- txsize tx &#8804; maxTxSize pp -}</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="annottext">Test (ShelleyUtxoPredFailure era) -&gt; Rule (utxo era) 'Transition ()
forall t sts (ctx :: RuleType).
Inject t (PredicateFailure sts) =&gt;
Test t -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">runTest</span></span><span> </span><span class="annot"><span class="annottext">(Test (ShelleyUtxoPredFailure era)
 -&gt; Rule (utxo era) 'Transition ())
-&gt; Test (ShelleyUtxoPredFailure era)
-&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Tx era -&gt; Test (ShelleyUtxoPredFailure era)
forall era.
EraTx era =&gt;
PParams era -&gt; Tx era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateMaxTxSizeUTxO"><span class="hs-identifier hs-var">validateMaxTxSizeUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
Signal (utxo era)
</span><a href="#local-6989586621679618658"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679618670"><span class="annot"><span class="annottext">refunded :: Coin
</span><a href="#local-6989586621679618670"><span class="hs-identifier hs-var hs-var">refunded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; CertState era -&gt; TxBody era -&gt; Coin
forall era.
ShelleyEraTxBody era =&gt;
PParams era -&gt; CertState era -&gt; TxBody era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.RefundsAndDeposits.html#keyTxRefunds"><span class="hs-identifier hs-var">keyTxRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618655"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679618671"><span class="annot"><span class="annottext">totalDeposits' :: Coin
</span><a href="#local-6989586621679618671"><span class="hs-identifier hs-var hs-var">totalDeposits'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; CertState era -&gt; TxBody era -&gt; Coin
forall era.
ShelleyEraTxBody era =&gt;
PParams era -&gt; CertState era -&gt; TxBody era -&gt; Coin
</span><a href="Cardano.Ledger.Shelley.Core.html#getTotalDepositsTxBody"><span class="hs-identifier hs-var">getTotalDepositsTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618655"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679618673"><span class="annot"><span class="annottext">depositChange :: Coin
</span><a href="#local-6989586621679618673"><span class="hs-identifier hs-var hs-var">depositChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618671"><span class="hs-identifier hs-var">totalDeposits'</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><span class="hs-operator hs-var">Val.&lt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618670"><span class="hs-identifier hs-var">refunded</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">Event (utxo era) -&gt; Rule (utxo era) 'Transition ()
forall sts (ctx :: RuleType). Event sts -&gt; Rule sts ctx ()
</span><span class="hs-identifier hs-var">tellEvent</span></span><span> </span><span class="annot"><span class="annottext">(Event (utxo era) -&gt; Rule (utxo era) 'Transition ())
-&gt; Event (utxo era) -&gt; Rule (utxo era) 'Transition ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; Coin -&gt; UtxoEvent era
forall era.
SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; Coin -&gt; UtxoEvent era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#TotalDeposits"><span class="hs-identifier hs-var">TotalDeposits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; SafeHash (EraCrypto era) EraIndependentTxBody
forall x index c.
(HashAnnotated x index c, HashAlgorithm (HASH c)) =&gt;
x -&gt; SafeHash c index
</span><span class="hs-identifier hs-var">hashAnnotated</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618673"><span class="hs-identifier hs-var">depositChange</span></a></span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">UTxOState era -&gt; F (Clause (utxo era) 'Transition) (UTxOState era)
forall a. a -&gt; F (Clause (utxo era) 'Transition) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(UTxOState era
 -&gt; F (Clause (utxo era) 'Transition) (UTxOState era))
-&gt; UTxOState era
-&gt; F (Clause (utxo era) 'Transition) (UTxOState era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; UTxOState era
-&gt; TxBody era
-&gt; Coin
-&gt; GovState era
-&gt; UTxOState era
forall era.
EraTxBody era =&gt;
PParams era
-&gt; UTxOState era
-&gt; TxBody era
-&gt; Coin
-&gt; GovState era
-&gt; UTxOState era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#updateUTxOState"><span class="hs-identifier hs-var">updateUTxOState</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618654"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">State (utxo era)
UTxOState era
</span><a href="#local-6989586621679618657"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618661"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618673"><span class="hs-identifier hs-var">depositChange</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGovState era
GovState era
</span><a href="#local-6989586621679618667"><span class="hs-identifier hs-var">ppup'</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | The ttl field marks the top of an open interval, so it must be strictly</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- less than the slot, so fail if it is (&gt;=).</span><span>
</span><span id="line-459"></span><span class="hs-comment">--</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- &gt; txttl txb &#8805; slot</span><span>
</span><span id="line-461"></span><span id="local-6989586621679617038"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateTimeToLive"><span class="hs-identifier hs-type">validateTimeToLive</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Core.html#ShelleyEraTxBody"><span class="hs-identifier hs-type">ShelleyEraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617038"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExactEra</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617038"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617038"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617038"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-466"></span><span id="validateTimeToLive"><span class="annot"><span class="annottext">validateTimeToLive :: forall era.
(ShelleyEraTxBody era, ExactEra ShelleyEra era) =&gt;
TxBody era -&gt; SlotNo -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateTimeToLive"><span class="hs-identifier hs-var hs-var">validateTimeToLive</span></a></span></span><span> </span><span id="local-6989586621679618684"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618684"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span id="local-6989586621679618685"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618685"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618686"><span class="hs-identifier hs-var">ttl</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618685"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; ShelleyUtxoPredFailure era
forall era. SlotNo -&gt; SlotNo -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ExpiredUTxO"><span class="hs-identifier hs-var">ExpiredUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618686"><span class="hs-identifier hs-var">ttl</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679618685"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679618686"><span class="annot"><span class="annottext">ttl :: SlotNo
</span><a href="#local-6989586621679618686"><span class="hs-identifier hs-var hs-var">ttl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618684"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Getting SlotNo (TxBody era) SlotNo -&gt; SlotNo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting SlotNo (TxBody era) SlotNo
forall era.
(ShelleyEraTxBody era, ExactEra ShelleyEra era) =&gt;
Lens' (TxBody era) SlotNo
Lens' (TxBody era) SlotNo
</span><a href="Cardano.Ledger.Shelley.Core.html#ttlTxBodyL"><span class="hs-identifier hs-var">ttlTxBodyL</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Ensure that there is at least one input in the `TxBody`</span><span>
</span><span id="line-471"></span><span class="hs-comment">--</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- &gt; txins txb &#8800; &#8709;</span><span>
</span><span id="line-473"></span><span id="local-6989586621679617039"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateInputSetEmptyUTxO"><span class="hs-identifier hs-type">validateInputSetEmptyUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EraTxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617039"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617039"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617039"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-477"></span><span id="validateInputSetEmptyUTxO"><span class="annot"><span class="annottext">validateInputSetEmptyUTxO :: forall era.
EraTxBody era =&gt;
TxBody era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateInputSetEmptyUTxO"><span class="hs-identifier hs-var hs-var">validateInputSetEmptyUTxO</span></a></span></span><span> </span><span id="local-6989586621679618693"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618693"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618694"><span class="hs-identifier hs-var">txins</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era)) -&gt; Set (TxIn (EraCrypto era)) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
forall a. Set a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShelleyUtxoPredFailure era
forall era. ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#InputSetEmptyUTxO"><span class="hs-identifier hs-var">InputSetEmptyUTxO</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679618694"><span class="annot"><span class="annottext">txins :: Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618694"><span class="hs-identifier hs-var hs-var">txins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618693"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Getting
     (Set (TxIn (EraCrypto era)))
     (TxBody era)
     (Set (TxIn (EraCrypto era)))
-&gt; Set (TxIn (EraCrypto era))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Set (TxIn (EraCrypto era)))
  (TxBody era)
  (Set (TxIn (EraCrypto era)))
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (Set (TxIn (EraCrypto era)))
Lens' (TxBody era) (Set (TxIn (EraCrypto era)))
</span><span class="hs-identifier hs-var">inputsTxBodyL</span></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Ensure that the fee is at least the amount specified by the `minfee`</span><span>
</span><span id="line-483"></span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- &gt; minfee pp tx &#8804; txfee txb</span><span>
</span><span id="line-485"></span><span id="local-6989586621679617040"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateFeeTooSmallUTxO"><span class="hs-identifier hs-type">validateFeeTooSmallUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EraTx</span></span><span> </span><span class="annot"><a href="#local-6989586621679617040"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679617040"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679617040"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617040"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-490"></span><span id="validateFeeTooSmallUTxO"><span class="annot"><span class="annottext">validateFeeTooSmallUTxO :: forall era.
EraTx era =&gt;
PParams era -&gt; Tx era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateFeeTooSmallUTxO"><span class="hs-identifier hs-var hs-var">validateFeeTooSmallUTxO</span></a></span></span><span> </span><span id="local-6989586621679618705"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618705"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679618706"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679618706"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618707"><span class="hs-identifier hs-var">minFee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618709"><span class="hs-identifier hs-var">txFee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; ShelleyUtxoPredFailure era
forall era. Coin -&gt; Coin -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#FeeTooSmallUTxO"><span class="hs-identifier hs-var">FeeTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618707"><span class="hs-identifier hs-var">minFee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618709"><span class="hs-identifier hs-var">txFee</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-493"></span><span>    </span><span id="local-6989586621679618707"><span class="annot"><span class="annottext">minFee :: Coin
</span><a href="#local-6989586621679618707"><span class="hs-identifier hs-var hs-var">minFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Tx era -&gt; Coin
forall era. EraTx era =&gt; PParams era -&gt; Tx era -&gt; Coin
</span><span class="hs-identifier hs-var">getMinFeeTx</span></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618705"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679618706"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span id="local-6989586621679618709"><span class="annot"><span class="annottext">txFee :: Coin
</span><a href="#local-6989586621679618709"><span class="hs-identifier hs-var hs-var">txFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618711"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Getting Coin (TxBody era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (TxBody era) Coin
forall era. EraTxBody era =&gt; Lens' (TxBody era) Coin
Lens' (TxBody era) Coin
</span><span class="hs-identifier hs-var">feeTxBodyL</span></span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679618711"><span class="annot"><span class="annottext">txb :: TxBody era
</span><a href="#local-6989586621679618711"><span class="hs-identifier hs-var hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679618706"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Getting (TxBody era) (Tx era) (TxBody era) -&gt; TxBody era
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (TxBody era) (Tx era) (TxBody era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxBody era)
Lens' (Tx era) (TxBody era)
</span><span class="hs-identifier hs-var">bodyTxL</span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- | Ensure all transaction inputs are present in `UTxO`</span><span>
</span><span id="line-498"></span><span class="hs-comment">--</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- &gt; inputs &#8838; dom utxo</span><span>
</span><span id="line-500"></span><span id="local-6989586621679617041"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateBadInputsUTxO"><span class="hs-identifier hs-type">validateBadInputsUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679617041"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraCrypto</span></span><span> </span><span class="annot"><a href="#local-6989586621679617041"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617041"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-504"></span><span id="validateBadInputsUTxO"><span class="annot"><span class="annottext">validateBadInputsUTxO :: forall era.
UTxO era
-&gt; Set (TxIn (EraCrypto era)) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateBadInputsUTxO"><span class="hs-identifier hs-var hs-var">validateBadInputsUTxO</span></a></span></span><span> </span><span id="local-6989586621679618715"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618715"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679618716"><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618716"><span class="hs-identifier hs-var">txins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era)) -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">Set.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618718"><span class="hs-identifier hs-var">badInputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
forall era.
Set (TxIn (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#BadInputsUTxO"><span class="hs-identifier hs-var">BadInputsUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618718"><span class="hs-identifier hs-var">badInputs</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-comment">{- inputs &#10134; dom utxo -}</span><span>
</span><span id="line-508"></span><span>    </span><span id="local-6989586621679618718"><span class="annot"><span class="annottext">badInputs :: Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618718"><span class="hs-identifier hs-var hs-var">badInputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxIn (EraCrypto era) -&gt; Bool)
-&gt; Set (TxIn (EraCrypto era)) -&gt; Set (TxIn (EraCrypto era))
forall a. (a -&gt; Bool) -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#filter"><span class="hs-identifier hs-var">Set.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#notMember"><span class="hs-operator hs-var">`Map.notMember`</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
forall era. UTxO era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><span class="hs-identifier hs-var">unUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618715"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621679618716"><span class="hs-identifier hs-var">txins</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | Make sure all addresses match the supplied NetworkId</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- &gt; &#8704;(_ &#8594; (a, _)) &#8712; txouts txb, netId a = NetworkId</span><span>
</span><span id="line-513"></span><span id="local-6989586621679617049"><span id="local-6989586621679617050"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetwork"><span class="hs-identifier hs-type">validateWrongNetwork</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraTxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679617049"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617050"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Network</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><a href="#local-6989586621679617050"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679617049"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617049"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-518"></span><span id="validateWrongNetwork"><span class="annot"><span class="annottext">validateWrongNetwork :: forall era (f :: * -&gt; *).
(EraTxOut era, Foldable f) =&gt;
Network -&gt; f (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetwork"><span class="hs-identifier hs-var hs-var">validateWrongNetwork</span></a></span></span><span> </span><span id="local-6989586621679618733"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618733"><span class="hs-identifier hs-var">netId</span></a></span></span><span> </span><span id="local-6989586621679618734"><span class="annot"><span class="annottext">f (TxOut era)
</span><a href="#local-6989586621679618734"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Addr (EraCrypto era)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621679618736"><span class="hs-identifier hs-var">addrsWrongNetwork</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Set (Addr (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
forall era.
Network -&gt; Set (Addr (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetwork"><span class="hs-identifier hs-var">WrongNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618733"><span class="hs-identifier hs-var">netId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Addr (EraCrypto era)] -&gt; Set (Addr (EraCrypto era))
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621679618736"><span class="hs-identifier hs-var">addrsWrongNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-521"></span><span>    </span><span id="local-6989586621679618736"><span class="annot"><span class="annottext">addrsWrongNetwork :: [Addr (EraCrypto era)]
</span><a href="#local-6989586621679618736"><span class="hs-identifier hs-var hs-var">addrsWrongNetwork</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>      </span><span class="annot"><span class="annottext">(Addr (EraCrypto era) -&gt; Bool)
-&gt; [Addr (EraCrypto era)] -&gt; [Addr (EraCrypto era)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-523"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679618738"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621679618738"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era) -&gt; Network
forall c. Addr c -&gt; Network
</span><span class="hs-identifier hs-var">getNetwork</span></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621679618738"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Network -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618733"><span class="hs-identifier hs-var">netId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Addr (EraCrypto era)) (TxOut era) (Addr (EraCrypto era))
-&gt; TxOut era -&gt; Addr (EraCrypto era)
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Addr (EraCrypto era)) (TxOut era) (Addr (EraCrypto era))
forall era.
EraTxOut era =&gt;
Lens' (TxOut era) (Addr (EraCrypto era))
Lens' (TxOut era) (Addr (EraCrypto era))
</span><span class="hs-identifier hs-var">addrTxOutL</span></span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; Addr (EraCrypto era))
-&gt; [TxOut era] -&gt; [Addr (EraCrypto era)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f (TxOut era) -&gt; [TxOut era]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">f (TxOut era)
</span><a href="#local-6989586621679618734"><span class="hs-identifier hs-var">outputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">-- | Make sure all addresses match the supplied NetworkId</span><span>
</span><span id="line-527"></span><span class="hs-comment">--</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- &gt; &#8704;(a &#8594; ) &#8712; txwdrls txb, netId a = NetworkId</span><span>
</span><span id="line-529"></span><span id="local-6989586621679617051"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetworkWithdrawal"><span class="hs-identifier hs-type">validateWrongNetworkWithdrawal</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Core.html#ShelleyEraTxBody"><span class="hs-identifier hs-type">ShelleyEraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617051"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Network</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617051"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617051"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-534"></span><span id="validateWrongNetworkWithdrawal"><span class="annot"><span class="annottext">validateWrongNetworkWithdrawal :: forall era.
ShelleyEraTxBody era =&gt;
Network -&gt; TxBody era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateWrongNetworkWithdrawal"><span class="hs-identifier hs-var hs-var">validateWrongNetworkWithdrawal</span></a></span></span><span> </span><span id="local-6989586621679618748"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618748"><span class="hs-identifier hs-var">netId</span></a></span></span><span> </span><span id="local-6989586621679618749"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618749"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RewardAcnt (EraCrypto era)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[RewardAcnt (EraCrypto era)]
</span><a href="#local-6989586621679618750"><span class="hs-identifier hs-var">withdrawalsWrongNetwork</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><span class="annottext">Network
-&gt; Set (RewardAcnt (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
forall era.
Network
-&gt; Set (RewardAcnt (EraCrypto era)) -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#WrongNetworkWithdrawal"><span class="hs-identifier hs-var">WrongNetworkWithdrawal</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618748"><span class="hs-identifier hs-var">netId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RewardAcnt (EraCrypto era)] -&gt; Set (RewardAcnt (EraCrypto era))
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[RewardAcnt (EraCrypto era)]
</span><a href="#local-6989586621679618750"><span class="hs-identifier hs-var">withdrawalsWrongNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679618750"><span class="annot"><span class="annottext">withdrawalsWrongNetwork :: [RewardAcnt (EraCrypto era)]
</span><a href="#local-6989586621679618750"><span class="hs-identifier hs-var hs-var">withdrawalsWrongNetwork</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><span class="annottext">(RewardAcnt (EraCrypto era) -&gt; Bool)
-&gt; [RewardAcnt (EraCrypto era)] -&gt; [RewardAcnt (EraCrypto era)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-540"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679618751"><span class="annot"><span class="annottext">RewardAcnt (EraCrypto era)
</span><a href="#local-6989586621679618751"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RewardAcnt (EraCrypto era) -&gt; Network
forall c. RewardAcnt c -&gt; Network
</span><span class="hs-identifier hs-var">getRwdNetwork</span></span><span> </span><span class="annot"><span class="annottext">RewardAcnt (EraCrypto era)
</span><a href="#local-6989586621679618751"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Network -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679618748"><span class="hs-identifier hs-var">netId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (RewardAcnt (EraCrypto era)) Coin
-&gt; [RewardAcnt (EraCrypto era)]
forall k a. Map k a -&gt; [k]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">Map.keys</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (RewardAcnt (EraCrypto era)) Coin
 -&gt; [RewardAcnt (EraCrypto era)])
-&gt; (Withdrawals (EraCrypto era)
    -&gt; Map (RewardAcnt (EraCrypto era)) Coin)
-&gt; Withdrawals (EraCrypto era)
-&gt; [RewardAcnt (EraCrypto era)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Withdrawals (EraCrypto era)
-&gt; Map (RewardAcnt (EraCrypto era)) Coin
forall c. Withdrawals c -&gt; Map (RewardAcnt c) Coin
</span><span class="hs-identifier hs-var">unWithdrawals</span></span><span> </span><span class="annot"><span class="annottext">(Withdrawals (EraCrypto era) -&gt; [RewardAcnt (EraCrypto era)])
-&gt; Withdrawals (EraCrypto era) -&gt; [RewardAcnt (EraCrypto era)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618749"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Getting
     (Withdrawals (EraCrypto era))
     (TxBody era)
     (Withdrawals (EraCrypto era))
-&gt; Withdrawals (EraCrypto era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Withdrawals (EraCrypto era))
  (TxBody era)
  (Withdrawals (EraCrypto era))
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (Withdrawals (EraCrypto era))
Lens' (TxBody era) (Withdrawals (EraCrypto era))
</span><span class="hs-identifier hs-var">withdrawalsTxBodyL</span></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-comment">-- | Ensure that value consumed and produced matches up exactly</span><span>
</span><span id="line-544"></span><span class="hs-comment">--</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- &gt; consumed pp utxo txb = produced pp poolParams txb</span><span>
</span><span id="line-546"></span><span id="local-6989586621679617052"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateValueNotConservedUTxO"><span class="hs-identifier hs-type">validateValueNotConservedUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Core.html#ShelleyEraTxBody"><span class="hs-identifier hs-type">ShelleyEraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraUTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CertState</span></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-553"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617052"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-555"></span><span id="validateValueNotConservedUTxO"><span class="annot"><span class="annottext">validateValueNotConservedUTxO :: forall era.
(ShelleyEraTxBody era, EraUTxO era) =&gt;
PParams era
-&gt; UTxO era
-&gt; CertState era
-&gt; TxBody era
-&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateValueNotConservedUTxO"><span class="hs-identifier hs-var hs-var">validateValueNotConservedUTxO</span></a></span></span><span> </span><span id="local-6989586621679618763"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618763"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679618764"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618764"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679618765"><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618765"><span class="hs-identifier hs-var">dpstate</span></a></span></span><span> </span><span id="local-6989586621679618766"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618766"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679618767"><span class="hs-identifier hs-var">consumedValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679618768"><span class="hs-identifier hs-var">producedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; ShelleyUtxoPredFailure era
forall era. Value era -&gt; Value era -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ValueNotConservedUTxO"><span class="hs-identifier hs-var">ValueNotConservedUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679618767"><span class="hs-identifier hs-var">consumedValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621679618768"><span class="hs-identifier hs-var">producedValue</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679618767"><span class="annot"><span class="annottext">consumedValue :: Value era
</span><a href="#local-6989586621679618767"><span class="hs-identifier hs-var hs-var">consumedValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; CertState era -&gt; UTxO era -&gt; TxBody era -&gt; Value era
forall era.
EraUTxO era =&gt;
PParams era -&gt; CertState era -&gt; UTxO era -&gt; TxBody era -&gt; Value era
</span><a href="Cardano.Ledger.Shelley.UTxO.html#consumed"><span class="hs-identifier hs-var">consumed</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618763"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618765"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618764"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618766"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621679618768"><span class="annot"><span class="annottext">producedValue :: Value era
</span><a href="#local-6989586621679618768"><span class="hs-identifier hs-var hs-var">producedValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; CertState era -&gt; TxBody era -&gt; Value era
forall era.
EraUTxO era =&gt;
PParams era -&gt; CertState era -&gt; TxBody era -&gt; Value era
</span><a href="Cardano.Ledger.Shelley.UTxO.html#produced"><span class="hs-identifier hs-var">produced</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618763"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621679618765"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618766"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- | Ensure there are no `TxOut`s that have less than @minUTxOValue@</span><span>
</span><span id="line-562"></span><span class="hs-comment">--</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- &gt; &#8704;(_ &#8594; (_, c)) &#8712; txouts txb, c &#8805; (minUTxOValue pp)</span><span>
</span><span id="line-564"></span><span id="local-6989586621679617059"><span id="local-6989586621679617060"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputTooSmallUTxO"><span class="hs-identifier hs-type">validateOutputTooSmallUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraTxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679617059"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617060"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679617059"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><a href="#local-6989586621679617060"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679617059"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617059"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-569"></span><span id="validateOutputTooSmallUTxO"><span class="annot"><span class="annottext">validateOutputTooSmallUTxO :: forall era (f :: * -&gt; *).
(EraTxOut era, Foldable f) =&gt;
PParams era -&gt; f (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputTooSmallUTxO"><span class="hs-identifier hs-var hs-var">validateOutputTooSmallUTxO</span></a></span></span><span> </span><span id="local-6989586621679618779"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618779"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679618780"><span class="annot"><span class="annottext">f (TxOut era)
</span><a href="#local-6989586621679618780"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxOut era] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679618781"><span class="hs-identifier hs-var">outputsTooSmall</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; ShelleyUtxoPredFailure era
forall era. [TxOut era] -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputTooSmallUTxO"><span class="hs-identifier hs-var">OutputTooSmallUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679618781"><span class="hs-identifier hs-var">outputsTooSmall</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-comment">-- minUTxOValue deposit comparison done as Coin because this rule is correct</span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-comment">-- strictly in the Shelley era (in ShelleyMA we additionally check that all</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-comment">-- amounts are non-negative)</span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621679618781"><span class="annot"><span class="annottext">outputsTooSmall :: [TxOut era]
</span><a href="#local-6989586621679618781"><span class="hs-identifier hs-var hs-var">outputsTooSmall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-576"></span><span>      </span><span class="annot"><span class="annottext">(TxOut era -&gt; Bool) -&gt; [TxOut era] -&gt; [TxOut era]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-577"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679618782"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679618782"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679618782"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Getting Coin (TxOut era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (TxOut era) Coin
forall era. (HasCallStack, EraTxOut era) =&gt; Lens' (TxOut era) Coin
Lens' (TxOut era) Coin
</span><span class="hs-identifier hs-var">coinTxOutL</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; TxOut era -&gt; Coin
forall era. EraTxOut era =&gt; PParams era -&gt; TxOut era -&gt; Coin
</span><span class="hs-identifier hs-var">getMinCoinTxOut</span></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618779"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679618782"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (TxOut era) -&gt; [TxOut era]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">f (TxOut era)
</span><a href="#local-6989586621679618780"><span class="hs-identifier hs-var">outputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="hs-comment">-- | Bootstrap (i.e. Byron) addresses have variable sized attributes in them.</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- It is important to limit their overall size.</span><span>
</span><span id="line-582"></span><span class="hs-comment">--</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- &gt; &#8704; ( _ &#8614; (a,_)) &#8712; txoutstxb,  a &#8712; Addrbootstrap &#8594; bootstrapAttrsSize a &#8804; 64</span><span>
</span><span id="line-584"></span><span id="local-6989586621679617061"><span id="local-6989586621679617062"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputBootAddrAttrsTooBig"><span class="hs-identifier hs-type">validateOutputBootAddrAttrsTooBig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraTxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679617061"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617062"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><a href="#local-6989586621679617062"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679617061"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617061"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-588"></span><span id="validateOutputBootAddrAttrsTooBig"><span class="annot"><span class="annottext">validateOutputBootAddrAttrsTooBig :: forall era (f :: * -&gt; *).
(EraTxOut era, Foldable f) =&gt;
f (TxOut era) -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateOutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var hs-var">validateOutputBootAddrAttrsTooBig</span></a></span></span><span> </span><span id="local-6989586621679618794"><span class="annot"><span class="annottext">f (TxOut era)
</span><a href="#local-6989586621679618794"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-589"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxOut era] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679618795"><span class="hs-identifier hs-var">outputsAttrsTooBig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; ShelleyUtxoPredFailure era
forall era. [TxOut era] -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#OutputBootAddrAttrsTooBig"><span class="hs-identifier hs-var">OutputBootAddrAttrsTooBig</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621679618795"><span class="hs-identifier hs-var">outputsAttrsTooBig</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-591"></span><span>    </span><span id="local-6989586621679618795"><span class="annot"><span class="annottext">outputsAttrsTooBig :: [TxOut era]
</span><a href="#local-6989586621679618795"><span class="hs-identifier hs-var hs-var">outputsAttrsTooBig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><span class="annottext">(TxOut era -&gt; Bool) -&gt; [TxOut era] -&gt; [TxOut era]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-593"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679618796"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679618796"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-594"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679618796"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
-&gt; Getting
     (Maybe (BootstrapAddress (EraCrypto era)))
     (TxOut era)
     (Maybe (BootstrapAddress (EraCrypto era)))
-&gt; Maybe (BootstrapAddress (EraCrypto era))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Maybe (BootstrapAddress (EraCrypto era)))
  (TxOut era)
  (Maybe (BootstrapAddress (EraCrypto era)))
forall era.
EraTxOut era =&gt;
SimpleGetter (TxOut era) (Maybe (BootstrapAddress (EraCrypto era)))
SimpleGetter (TxOut era) (Maybe (BootstrapAddress (EraCrypto era)))
</span><span class="hs-identifier hs-var">bootAddrTxOutF</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-595"></span><span>              </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679618798"><span class="annot"><span class="annottext">BootstrapAddress (EraCrypto era)
</span><a href="#local-6989586621679618798"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BootstrapAddress (EraCrypto era) -&gt; Int
forall c. BootstrapAddress c -&gt; Int
</span><span class="hs-identifier hs-var">bootstrapAddressAttrsSize</span></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress (EraCrypto era)
</span><a href="#local-6989586621679618798"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span>
</span><span id="line-596"></span><span>              </span><span class="annot"><span class="annottext">Maybe (BootstrapAddress (EraCrypto era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (TxOut era) -&gt; [TxOut era]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">f (TxOut era)
</span><a href="#local-6989586621679618794"><span class="hs-identifier hs-var">outputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-comment">-- | Ensure that the size of the transaction does not exceed the @maxTxSize@ protocol parameter</span><span>
</span><span id="line-601"></span><span class="hs-comment">--</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- &gt; txsize tx &#8804; maxTxSize pp</span><span>
</span><span id="line-603"></span><span id="local-6989586621679618800"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateMaxTxSizeUTxO"><span class="hs-identifier hs-type">validateMaxTxSizeUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EraTx</span></span><span> </span><span class="annot"><a href="#local-6989586621679618800"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-605"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679618800"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-606"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679618800"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679618800"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-608"></span><span id="validateMaxTxSizeUTxO"><span class="annot"><span class="annottext">validateMaxTxSizeUTxO :: forall era.
EraTx era =&gt;
PParams era -&gt; Tx era -&gt; Test (ShelleyUtxoPredFailure era)
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#validateMaxTxSizeUTxO"><span class="hs-identifier hs-var hs-var">validateMaxTxSizeUTxO</span></a></span></span><span> </span><span id="local-6989586621679618810"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618810"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679618811"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679618811"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-609"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall e. Bool -&gt; e -&gt; Validation (NonEmpty e) ()
</span><span class="hs-identifier hs-var">failureUnless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679618812"><span class="hs-identifier hs-var">txSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679618813"><span class="hs-identifier hs-var">maxTxSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShelleyUtxoPredFailure era
 -&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ())
-&gt; ShelleyUtxoPredFailure era
-&gt; Validation (NonEmpty (ShelleyUtxoPredFailure era)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; ShelleyUtxoPredFailure era
forall era. Integer -&gt; Integer -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#MaxTxSizeUTxO"><span class="hs-identifier hs-var">MaxTxSizeUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679618812"><span class="hs-identifier hs-var">txSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679618813"><span class="hs-identifier hs-var">maxTxSize</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-611"></span><span>    </span><span id="local-6989586621679618813"><span class="annot"><span class="annottext">maxTxSize :: Integer
</span><a href="#local-6989586621679618813"><span class="hs-identifier hs-var hs-var">maxTxSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618810"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Getting Nat (PParams era) Nat -&gt; Nat
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Nat (PParams era) Nat
forall era. EraPParams era =&gt; Lens' (PParams era) Nat
Lens' (PParams era) Nat
</span><span class="hs-identifier hs-var">ppMaxTxSizeL</span></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679618812"><span class="annot"><span class="annottext">txSize :: Integer
</span><a href="#local-6989586621679618812"><span class="hs-identifier hs-var hs-var">txSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679618811"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Getting Integer (Tx era) Integer -&gt; Integer
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Integer (Tx era) Integer
forall era. EraTx era =&gt; SimpleGetter (Tx era) Integer
SimpleGetter (Tx era) Integer
</span><span class="hs-identifier hs-var">sizeTxF</span></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span id="local-6989586621679617071"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#updateUTxOState"><span class="hs-identifier hs-type">updateUTxOState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">EraTxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617071"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-616"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PParams</span></span><span> </span><span class="annot"><a href="#local-6989586621679617071"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-617"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617071"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-618"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679617071"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-619"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Coin</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-620"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html#GovState"><span class="hs-identifier hs-type">GovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617071"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617071"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-622"></span><span id="updateUTxOState"><span class="annot"><span class="annottext">updateUTxOState :: forall era.
EraTxBody era =&gt;
PParams era
-&gt; UTxOState era
-&gt; TxBody era
-&gt; Coin
-&gt; GovState era
-&gt; UTxOState era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#updateUTxOState"><span class="hs-identifier hs-var hs-var">updateUTxOState</span></a></span></span><span> </span><span id="local-6989586621679618828"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618828"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679618829"><span class="annot"><span class="annottext">UTxO era
utxosUtxo :: forall era. UTxOState era -&gt; UTxO era
utxosUtxo :: UTxO era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosUtxo"><span class="hs-identifier hs-var hs-var">utxosUtxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618830"><span class="annot"><span class="annottext">Coin
utxosDeposited :: forall era. UTxOState era -&gt; Coin
utxosDeposited :: Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosDeposited"><span class="hs-identifier hs-var hs-var">utxosDeposited</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618831"><span class="annot"><span class="annottext">Coin
utxosFees :: forall era. UTxOState era -&gt; Coin
utxosFees :: Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosFees"><span class="hs-identifier hs-var hs-var">utxosFees</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618832"><span class="annot"><span class="annottext">IncrementalStake (EraCrypto era)
utxosStakeDistr :: IncrementalStake (EraCrypto era)
utxosStakeDistr :: forall era. UTxOState era -&gt; IncrementalStake (EraCrypto era)
</span><a href="#local-6989586621679618832"><span class="hs-identifier hs-var hs-var">utxosStakeDistr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618834"><span class="annot"><span class="annottext">Coin
utxosDonation :: Coin
utxosDonation :: forall era. UTxOState era -&gt; Coin
</span><a href="#local-6989586621679618834"><span class="hs-identifier hs-var hs-var">utxosDonation</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679618836"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618836"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span id="local-6989586621679618837"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618837"><span class="hs-identifier hs-var">depositChange</span></a></span></span><span> </span><span id="local-6989586621679618838"><span class="annot"><span class="annottext">GovState era
</span><a href="#local-6989586621679618838"><span class="hs-identifier hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679618839"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618839"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618829"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span>
</span><span id="line-624"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679618840"><span class="annot"><span class="annottext">utxoAdd :: UTxO era
</span><a href="#local-6989586621679618840"><span class="hs-identifier hs-var hs-var">utxoAdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; UTxO era
forall era. EraTxBody era =&gt; TxBody era -&gt; UTxO era
</span><span class="hs-identifier hs-var">txouts</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618836"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="hs-comment">-- These will be inserted into the UTxO</span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-comment">{- utxoDel  = txins txb &#9665; utxo -}</span><span>
</span><span id="line-626"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679618841"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618841"><span class="hs-identifier hs-var">utxoWithout</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679618842"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618842"><span class="hs-identifier hs-var">utxoDel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Set (TxIn (EraCrypto era))
-&gt; (Map (TxIn (EraCrypto era)) (TxOut era),
    Map (TxIn (EraCrypto era)) (TxOut era))
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; (Map k a, Map k a)
</span><span class="hs-identifier hs-var">extractKeys</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618839"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618836"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Getting
     (Set (TxIn (EraCrypto era)))
     (TxBody era)
     (Set (TxIn (EraCrypto era)))
-&gt; Set (TxIn (EraCrypto era))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Set (TxIn (EraCrypto era)))
  (TxBody era)
  (Set (TxIn (EraCrypto era)))
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (Set (TxIn (EraCrypto era)))
Lens' (TxBody era) (Set (TxIn (EraCrypto era)))
</span><span class="hs-identifier hs-var">inputsTxBodyL</span></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>      </span><span class="hs-comment">{- newUTxO = (txins txb &#8938; utxo) &#8746; outs txb -}</span><span>
</span><span id="line-628"></span><span>      </span><span id="local-6989586621679618843"><span class="annot"><span class="annottext">newUTxO :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618843"><span class="hs-identifier hs-var hs-var">newUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618841"><span class="hs-identifier hs-var">utxoWithout</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; Map (TxIn (EraCrypto era)) (TxOut era)
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`Map.union`</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
forall era. UTxO era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><span class="hs-identifier hs-var">unUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618840"><span class="hs-identifier hs-var">utxoAdd</span></a></span><span>
</span><span id="line-629"></span><span>      </span><span id="local-6989586621679618845"><span class="annot"><span class="annottext">newIncStakeDistro :: IncrementalStake (EraCrypto era)
</span><a href="#local-6989586621679618845"><span class="hs-identifier hs-var hs-var">newIncStakeDistro</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; IncrementalStake (EraCrypto era)
-&gt; UTxO era
-&gt; UTxO era
-&gt; IncrementalStake (EraCrypto era)
forall era.
EraTxOut era =&gt;
PParams era
-&gt; IncrementalStake (EraCrypto era)
-&gt; UTxO era
-&gt; UTxO era
-&gt; IncrementalStake (EraCrypto era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.IncrementalStake.html#updateStakeDistribution"><span class="hs-identifier hs-var">updateStakeDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679618828"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">IncrementalStake (EraCrypto era)
</span><a href="#local-6989586621679618832"><span class="hs-identifier hs-var">utxosStakeDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
forall era. Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
</span><span class="hs-identifier hs-var">UTxO</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618842"><span class="hs-identifier hs-var">utxoDel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679618840"><span class="hs-identifier hs-var">utxoAdd</span></a></span><span>
</span><span id="line-630"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span>
</span><span id="line-631"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">utxosUtxo :: UTxO era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosUtxo"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
forall era. Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
</span><span class="hs-identifier hs-var">UTxO</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621679618843"><span class="hs-identifier hs-var">newUTxO</span></a></span><span>
</span><span id="line-632"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosDeposited :: Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosDeposited"><span class="hs-identifier hs-var">utxosDeposited</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618830"><span class="hs-identifier hs-var">utxosDeposited</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618837"><span class="hs-identifier hs-var">depositChange</span></a></span><span>
</span><span id="line-633"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosFees :: Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosFees"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618831"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679618836"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Getting Coin (TxBody era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (TxBody era) Coin
forall era. EraTxBody era =&gt; Lens' (TxBody era) Coin
Lens' (TxBody era) Coin
</span><span class="hs-identifier hs-var">feeTxBodyL</span></span><span>
</span><span id="line-634"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosGovState :: GovState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosGovState"><span class="hs-identifier hs-var">utxosGovState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GovState era
</span><a href="#local-6989586621679618838"><span class="hs-identifier hs-var">govState</span></a></span><span>
</span><span id="line-635"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosStakeDistr :: IncrementalStake (EraCrypto era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosStakeDistr"><span class="hs-identifier hs-var">utxosStakeDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IncrementalStake (EraCrypto era)
</span><a href="#local-6989586621679618845"><span class="hs-identifier hs-var">newIncStakeDistro</span></a></span><span>
</span><span id="line-636"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosDonation :: Coin
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosDonation"><span class="hs-identifier hs-var">utxosDonation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679618834"><span class="hs-identifier hs-var">utxosDonation</span></a></span><span>
</span><span id="line-637"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-640"></span><span>  </span><span id="local-6989586621679617132"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Era</span></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyPPUP"><span class="hs-identifier hs-type">ShelleyPPUP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#ShelleyPpupPredFailure"><span class="hs-identifier hs-type">ShelleyPpupPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraRule</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PPUP&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PpupEvent"><span class="hs-identifier hs-type">PpupEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Embed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyPPUP"><span class="hs-identifier hs-type">ShelleyPPUP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html#ShelleyUTXO"><span class="hs-identifier hs-type">ShelleyUTXO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617132"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-647"></span><span>  </span><span id="local-6989586621679618863"><span class="annot"><span class="annottext">wrapFailed :: PredicateFailure (ShelleyPPUP era)
-&gt; PredicateFailure (ShelleyUTXO era)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">wrapFailed</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PredicateFailure (ShelleyPPUP era)
-&gt; PredicateFailure (ShelleyUTXO era)
PPUPPredFailure era -&gt; ShelleyUtxoPredFailure era
forall era. PPUPPredFailure era -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span id="local-6989586621679618864"><span class="annot"><span class="annottext">wrapEvent :: Event (ShelleyPPUP era) -&gt; Event (ShelleyUTXO era)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">wrapEvent</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Event (EraRule &quot;PPUP&quot; era) -&gt; UtxoEvent era
Event (ShelleyPPUP era) -&gt; Event (ShelleyUTXO era)
forall era. Event (EraRule &quot;PPUP&quot; era) -&gt; UtxoEvent era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateEvent"><span class="hs-identifier hs-var">UpdateEvent</span></a></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="hs-comment">-- =================================</span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-653"></span><span>  </span><span id="local-6989586621679617136"><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#PPUPPredFailure"><span class="hs-identifier hs-type">PPUPPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617136"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#ShelleyPpupPredFailure"><span class="hs-identifier hs-type">ShelleyPpupPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617136"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-654"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Inject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Ppup.html#ShelleyPpupPredFailure"><span class="hs-identifier hs-type">ShelleyPpupPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617136"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617136"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>  </span><span id="local-6989586621679618870"><span class="annot"><span class="annottext">inject :: ShelleyPpupPredFailure era -&gt; ShelleyUtxoPredFailure era
</span><a href="#local-6989586621679618870"><span class="hs-identifier hs-var hs-var hs-var hs-var">inject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PPUPPredFailure era -&gt; ShelleyUtxoPredFailure era
ShelleyPpupPredFailure era -&gt; ShelleyUtxoPredFailure era
forall era. PPUPPredFailure era -&gt; ShelleyUtxoPredFailure era
</span><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#UpdateFailure"><span class="hs-identifier hs-var">UpdateFailure</span></a></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679617027"><span class="annot"><span class="hs-identifier hs-type">Inject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617027"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Rules.Utxo.html#ShelleyUtxoPredFailure"><span class="hs-identifier hs-type">ShelleyUtxoPredFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679617027"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-659"></span><span>  </span><span id="local-6989586621679618873"><span class="annot"><span class="annottext">inject :: ShelleyUtxoPredFailure era -&gt; ShelleyUtxoPredFailure era
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">inject</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyUtxoPredFailure era -&gt; ShelleyUtxoPredFailure era
forall a. a -&gt; a
</span><a href="file:///nix/store/iq1rbfvif2j9czimi3xf9cqxpanh5494-ghc-9.6.3-doc/share/doc/ghc-9.6.3/html/libraries/base-4.18.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-660"></span></pre></body></html>